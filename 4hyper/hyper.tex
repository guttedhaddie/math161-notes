\graphicspath{{4hyper/asy/}}

\section{Hyperbolic Geometry}\label{chap:hyper}

\subsection{History: Saccheri, Lambert and Absolute Geometry}\label{sec:hyp1}

For 2000 years after Euclid, many mathematicians believed that his parallel postulate could not be an independent axiom. Rigorous work on this problem was undertaken by Giovanni Saccheri (1667--1733) \& Johann Lambert (1728--1777); both attempted to force contradictions by assuming the negation of the parallel postulate. While this approach ultimately failed, their insights supplied the foundation of a new \emph{non-Euclidean} geometry. Before considering their work, we define some terms and recall our earlier discussion of parallels (pages \pageref{pg:parallelexist}--\pageref*{pg:pythagoras}).

\begin{defn}{}{}
	\emph{Absolute} or \emph{neutral} geometry is the axiomatic system comprising all of Hilbert's axioms except Playfair. Euclidean geometry is therefore a special case of neutral geometry.\smallbreak
	A \emph{non-Euclidean geometry} is (typically) a model satisfying most of Hilbert's axioms but for which parallels might not exist or are non-unique:
	\begin{quote}
		There exists a line $\ell$ and a point $P\not\in\ell$ through which there are \emph{no parallels} or \emph{at least two.}
	\end{quote}
\end{defn}

For instance, spherical geometry is non-Euclidean since there are no parallel lines---Hilbert's axioms I-2 and O-3 are false, as is the exterior angle theorem.


\boldinline{Results in absolute geometry}

The conclusions of Euclid's first 28 theorems are valid.

\begin{minipage}[t]{0.7\linewidth}\vspace{-2pt}
	\begin{itemize}\itemsep2pt
	  \item Basic constructions: bisectors, perpendiculars, etc.
	  \item Triangle congruence theorems: SAS, ASA, SAA, SSS.
	  \item Exterior angle theorem and its consequences:
 	\end{itemize}
\end{minipage}
\hfill
\begin{minipage}[t]{0.29\linewidth}\vspace{-7pt}
	\flushright\includegraphics[scale=0.95]{history-playfair}
\end{minipage}\par
\vspace{-6pt}
\begin{itemize}\itemsep2pt
	\item[]\begin{itemize}
	  \item Side/angle comparison and triangle inequality (Exercise \ref*{sec:hilbert2}.\ref{ex:euclidi19}).
	  \item \emph{Existence} of a parallel $m$ to a line $\ell$ through a point $P\not\in\ell$ via congruent angles
	  \[
	  	\alpha\cong\beta\implies \ell\parallel m
	  \]
	\end{itemize}
\end{itemize}



\boldinline{Arguments making use of unique parallels}\phantomsection\label{pg:absolute}

The following results were proved using Playfair's axiom or the parallel postulate, whence the \emph{arguments} are false in absolute geometry:
\begin{itemize}\itemsep2pt
  \item A line crossing parallel lines makes congruent angles: in the picture,  $\ell\parallel m\implies \alpha\cong\beta$. This is the uniqueness claim in Playfair: the parallel $m$ to $\ell$ through $P$ is unique.
  \item Angles in a triangle sum to \ang{180}.
  \item Constructions of squares/rectangles.
  \item Pythagoras' Theorem.
\end{itemize}

While our \emph{arguments} for the above are false in absolute geometry, we cannot instantly claim that the \emph{results} are false, for there might be alternative proofs! To show that these results truly require unique parallels, we must exhibit a \emph{model} in which they are false---such will be described in the next section. The existence of this model explains why Saccheri and Lambert failed in their endeavors; the parallel postulate (Playfair) is indeed independent of Euclid's (Hilbert's) other axioms.

\goodbreak



\begin{minipage}[t]{0.62\linewidth}\vspace{0pt}
	\boldsubsubsection{The Saccheri--Legendre Theorem}
	
	We work in absolute geometry, starting with an extension of the exterior angle theorem based on Euclid's proof.\smallbreak
	Suppose $\triangle ABC$ has angle sum $\Sigma_\triangle$ and construct $M$ and $E$ following Euclid to the arrangement pictured. Observe:
\end{minipage}
\hfill
\begin{minipage}[t]{0.36\linewidth}\vspace{0pt}
	\flushright\includegraphics[scale=0.95]{history-saccheri}
\end{minipage}

\begin{enumerate}\itemsep0pt
  \def\lgbullet#1{\raisebox{-3pt}{\textcolor{#1}{\LARGE\textbullet}}}
  \item $\textcolor{magenta}{\measuredangle ACB}+\textcolor{orange}{\measuredangle CAB}=\textcolor{magenta}{\measuredangle ACB}+\textcolor{orange}{\measuredangle ACE}<\ang{180}$ is the exterior angle theorem. More generally, the exterior angle theorem says that the sum of \emph{any two} angles in a triangle is strictly less than \ang{180}.
  \item $\triangle ABC$ and $\triangle EBC$ have the \emph{same angle sum}
  \[
  	\Sigma_\triangle=\lgbullet{orange}+\lgbullet{Green} +\lgbullet{Cyan} +\lgbullet{magenta}
  \]
  Just look at the picture---remember that we do not know whether $\Sigma_\triangle=\ang{180}$!
  \item $\triangle EBC$ has at least one angle ($\textcolor{cyan}{\measuredangle EBC}$ or $\textcolor{Green}{\measuredangle BEC}$) measuring $\le\frac 12\measuredangle ABC$.
\end{enumerate}
Iterate this construction: if $\textcolor{cyan}{\measuredangle EBC}\le\frac 12\measuredangle ABC$, start by bisecting $\cl{CE}$; otherwise bisect $\cl{BC}\ldots$ The result is an infinite sequence of triangles $\triangle_1=\triangle EBC$, $\triangle_2$, $\triangle_3,\ldots$ with two crucial properties:
\begin{enumeratea}
  \item All triangles have \emph{same angle sum} $\Sigma_\triangle=\Sigma_{\triangle_1}=\Sigma_{\triangle_2}=\cdots$.
  \item $\triangle_n$ has at least one angle measuring $\alpha_n\le\frac 1{2^n}\measuredangle ABC$.
\end{enumeratea} 
Now suppose $\Sigma_\triangle=\ang{180}+\epsilon$ is strictly \emph{greater} than \ang{180}. Since $\lim\frac 1{2^n}=0$, we may choose $n$ large enough to guarantee $\alpha_n<\epsilon$. But then the sum of the \emph{other two} angles in $\triangle_n$ would be \emph{greater than} \ang{180}, contradicting the exterior angle theorem (observation 1)! We have proved a famous result.

\begin{thm}{Saccheri--Legendre}{saccleg}
	In absolute geometry, triangles have angle sum $\Sigma_\triangle\le \ang{180}$.
\end{thm}

Saccheri's failed hope was to prove \emph{equality} without invoking the parallel postulate. 


\boldsubsubsection{Saccheri and Lambert Quadrilaterals}

Two families of quadrilaterals in absolute geometry are named in honor of these pioneers.

\begin{defn}[lower separated=false, sidebyside, sidebyside align=top seam, sidebyside gap=0pt, righthand width=0.34\linewidth]{}{}
	A \emph{Saccheri quadrilateral} $ABCD$ satisfies
	\[
		\cl{AD}\cong\cl{BC}\quad\text{and}\quad \measuredangle DAB=\measuredangle CBA=\ang{90}
	\]
	$\cl{AB}$ is the \emph{base} and $\cl{CD}$ the \emph{summit.}\smallbreak
	The interior angles at $C$ and $D$ are the \emph{summit angles.}\medbreak
	A \emph{Lambert quadrilateral} has three right-angles; for instance $AMND$  in the picture.
	\tcblower
	\flushright\includegraphics{history-quad3}
\end{defn}

We draw these with curved sides to indicate that the summit angles need not be right-angles, though we haven't yet exhibited a model which shows they could be anything else. Regardless of how they are drawn, $\cl{AD}$, $\cl{BC}$ and $\cl{CD}$ are all \emph{segments}!
\goodbreak

The apparent symmetry of a Saccheri quadrilateral is not an illusion.

\begin{lemm}[lower separated=false, sidebyside, sidebyside align=top seam, sidebyside gap=0pt, righthand width=0.34\linewidth]{}{saccheribasic}
	\exstart If the base and summit of a Saccheri quadrilateral are bisected, we obtain congruent Lambert quadrilaterals.\vspace{-4pt}
	\begin{enumerate}\itemsep0pt\setcounter{enumi}{1}
	  \item The summit angles of a Saccheri quadrilateral are congruent.
		\item In Euclidean geometry, Saccheri and Lambert quadrilaterals are rectangles (four right-angles).
	\end{enumerate}
	\tcblower
	\flushright\includegraphics{history-quad4}
\end{lemm}

Parts 1 and 2 are exercises. We could interpret part 3 as saying that Saccheri and Lambert quadrilaterals are as close as we can get to rectangles in absolute geometry.

\begin{proof}[Proof of 3.]
	By part 1 we need only prove this for a Saccheri quadrilateral.
	Following the exterior angle theorem, $\overleftrightarrow{AB}$ is a crossing line making congruent right-angles, whence $\cl{AD}\parallel\cl{BC}$.\smallbreak
	However $\overleftrightarrow{CD}$ also crosses the same parallel lines. By the parallel postulate, the summit angles sum to a straight edge. Since these are congruent, they are both right-angles. 
\end{proof}

We now show that drawing \emph{acute} summit angles is justified by the Saccheri--Legendre Theorem.

\begin{thm}{}{summit90}
	The summit angles of a Saccheri quadrilateral measure $\le \ang{90}$. 
\end{thm}

\begin{proof}
	Suppose $ABCD$ is a Saccheri quadrilateral with base $\cl{AB}$.\par
	\begin{minipage}[t]{0.65\linewidth}\vspace{-4pt}
		Extend $\cl{CB}$ to $E$ (opposite side of $\cl{AB}$ to $C$) such that $\cl{BE}\cong\cl{DA}$. Let $M$ be the midpoint of $\cl{AB}$.\smallbreak
	SAS implies $\angle DAM\cong \triangle EBM$; the \textcolor{Magenta}{vertical angles} at $M$ are congruent, whence $M$ lies on $\cl{DE}$.
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.34\linewidth}\vspace{-22pt}
		\flushright\includegraphics[scale=0.9]{history-quad2}\vspace{-5pt}
	\end{minipage}\par
	By Saccheri--Legendre, the (congruent) \textcolor{orange}{summit angles} at $C$ and $D$ sum to
	\[
		\measuredangle ADC +\textcolor{orange}{\measuredangle DCB} =\textcolor{cyan}{\measuredangle ADM} +\textcolor{blue}{\measuredangle EDC} +\textcolor{orange}{\measuredangle DCE} =\textcolor{cyan}{\measuredangle CED} +\textcolor{blue}{\measuredangle EDC} +\textcolor{orange}{\measuredangle DCE} \le \ang{180} \tag*{\qedhere}
	\]
\end{proof}


\begin{exercises}
	Work in absolute geometry; you cannot use Playfair's Axiom or the parallel postulate!
	\begin{enumerate}
		\begin{minipage}[t]{0.66\linewidth}\vspace{-2pt}
		  \item Use the first picture to prove parts 1 and 2 of Lemma \ref{lemm:saccheribasic}.

		  \item Use the first picture to give an alternative proof of Theorem \ref{thm:summit90}.
		
			\item\label{exs:rectanglesplit} Suppose $\square ABCD$ has four right-angles (second picture). Show that $\cl{AC}$ splits $\square ABCD$ into two congruent triangles, and conclude that the opposite sides are congruent.\par
			Why is this question easier in Euclidean geometry?
	
			\item\label{exs:saccherisplit} Suppose two Saccheri quadrilaterals have congruent bases ($\cl{AB}$) and perpendicular sides ($\cl{AD},\cl{BC}$). Prove that they are congruent.
		    		
			\item (Hard!)\lstsp Suppose Saccheri quadrilaterals have congruent summits and perpendicular sides. Prove that the quadrilaterals are congruent.
		\end{minipage}
		\hfill
		\begin{minipage}[t]{0.33\linewidth}\vspace{-8pt}
			\flushright\includegraphics[scale=0.9]{history-saccheri2}\\
			\includegraphics[scale=0.9]{basic-rect}
		\end{minipage}	
	\end{enumerate}

\end{exercises}

\clearpage



\subsection{Models of Hyperbolic Geometry}\label{sec:hyp-models}

In the early 1800s, James Boylai, Carl Friedrich Gauss and Nikolai Lobashevsky independently took the next step. Rather than attempting to establish the parallel postulate as a theorem within Euclidean geometry, they defined a new geometry based on the first four of Euclid's postulates plus an alternative to the parallel postulate:

\begin{axiom}{Boylai--Lobashevshky/Hyperbolic Postulate}{}
	Given a line $\ell$ and a point $P\not\in\ell$, there exist \emph{at least two} parallel lines to $\ell$ through $P$.
\end{axiom}

The resulting axiomatic system\footnote{We assume all of Hilbert's axioms, replacing Playfair axiom with the hyperbolic postulate.} is called \emph{hyperbolic geometry.} Consistency was proved in the late 1800s by Beltrami, Klein and Poincaré, each of whom created models by defining point, line, etc., in novel ways. One of the simplest is named for Poincaré, though was first proposed by Beltrami.

\begin{defn}[lower separated=false, sidebyside, sidebyside align=top seam, sidebyside gap=0pt, righthand width=0.3\linewidth]{}{poincaredisk}
	The \emph{Poincaré disk} is the interior of the unit circle
	\[
		\bigl\{(x,y)\in\R^2:x^2+y^2<1\bigr\}
		\quad\text{or}\quad
		\bigl\{z\in\C:\nm z<1\bigr\}
	\]
	A \emph{hyperbolic line} is a diameter or a circular arc meeting the unit circle at right-angles.\smallbreak
	In the picture we have a \textcolor{red}{hyperbolic line $\ell$} and a \textcolor{blue}{point $P$}: also drawn are several \textcolor{Green}{parallel hyperbolic lines} to $\ell$ passing through $P$.\smallbreak
	Points on the boundary circle are termed \emph{omega-points}: these are \emph{not} in the Poincaré disk and are essentially `points at infinity.' 
	\tcblower
	\flushright\includegraphics{models-parallels}
\end{defn}

Since it depends only on the incidence axioms, there exists a unique hyperbolic line joining any two points in the Poincaré disk.\par

Hyperbolic lines may straightforwardly be described using equations in analytic geometry.

\begin{lemm}[lower separated=false, sidebyside, sidebyside align=top seam, sidebyside gap=0pt, righthand width=0.35\linewidth]{}{hypline}
	Every hyperbolic line in the Poincaré disk model is one of the following:
	\begin{itemize}
	  \item A diameter passing through $(c,d)\neq (0,0)$ with Euclidean equation $dx=cy$.
	  \item The arc of a (Euclidean) circle with equation
		\[
			x^2+y^2-2ax-2by+1=0\quad\text{where}\quad a^2+b^2>1
		\]
		and (Euclidean) center and radius
		\[
			C=(a,b)\quad\text{and}\quad r=\sqrt{a^2+b^2-1}
		\]
	\end{itemize}
	\tcblower
	\flushright\includegraphics[scale=0.9]{models-example}
\end{lemm}
\goodbreak


\begin{example}{}{}
	We compute the hyperbolic line through $P=(0,\frac 12)$ and $Q=(\frac 12,\frac 13)$ in the Poincaré disk: this is the picture shown in Lemma \ref{lemm:hypline}.\smallbreak
	Substitute into $x^2+y^2-2ax-2by+1=0$ to obtain a system of equations for $a,b$:
	\[
		\begin{cases}
			\frac 14-b+1=0\\
			\frac 14+\frac 19-a-\frac 23b+1=0
		\end{cases}
		\implies (a,b)=\left(\frac{19}{36},\frac 54\right)
	\]
	The required hyperbolic line $\lin{PQ}$ therefore has equation
	\[
		x^2+y^2-\frac{19}{18}x-\frac{5}{2}y+1=0
		\quad\text{or}\quad
		\left(x-\frac{19}{36}\right)^2+\left(y-\frac 54\right)^2 =\frac{545}{648}
	\]
\end{example}

The undefined terms \emph{point, line, on} and \emph{between} now make sense. To complete the model, we need to define \emph{congruence} of hyperbolic segments and angles.

\begin{defn*}{\ref{defn:poincaredisk} continued}
	The \emph{hyperbolic distance} between points $P,Q$ in the Poincaré disk is\footnotemark{}

	\begin{minipage}[t]{0.7\linewidth}\vspace{-12pt}
		\[
			d(P,Q):=\cosh^{-1}\left(1+\frac{2\nm{PQ}^2}{(1-\nm{P}^2)(1-\nm{Q}^2)}\right)
		\]
		where $\nm{PQ}$ is the Euclidean distance and $\nm P,\nm Q$ are the Euclidean distances of $P,Q$ from the origin.\smallbreak
		Hyperbolic segments are \emph{congruent} if they have the same length.\smallbreak
		The \emph{angle} between hyperbolic rays is that between their tangent lines: angles are congruent if they have the same measure.
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.29\linewidth}\vspace{-5pt}
		\flushright\includegraphics{models-angle}
	\end{minipage}
\end{defn*}

\begin{lemm}{}{distformula}
	The hyperbolic distance of $P$ from the origin is
	\[
		d(O,P)=\cosh^{-1}\frac{1+\nm P^2}{1-\nm P^2}=\ln\frac{1+\nm P}{1-\nm P}
	\]
\end{lemm}

\footnotetext{It seems reasonable for hyperbolic functions to play some role in hyperbolic geometry! As a primer:
  \[
  	\cosh x=\frac{e^x+e^{-x}}2,\quad \sinh x=\frac{e^x-e^{-x}}2,\quad\tanh x=\frac{\sinh x}{\cosh x}=\frac{e^x-e^{-x}}{e^x+e^{-x}}\quad\text{and}\quad\cosh^{-1}x=\ln(x+\sqrt{x^2-1})
  \]
  \vspace{-15pt}
}


\begin{example}{}{hypisosceles}
	We calculate the sides and angles in the isosceles right-triangle\par
	\begin{minipage}[t]{0.69\linewidth}\vspace{-8pt}
		with vertices $O=(0,0)$, $P=(\frac 12,0)$ and $Q=(0,\frac 12)$.
		\begin{gather*}
		\nm P=\tfrac 12=\nm Q,\qquad \nm{PQ}^2=\tfrac 14+\tfrac 14=\tfrac 12\\
		d(O,P)=d(O,Q)=\ln\frac{1+\frac 12}{1-\frac 12}=\ln 3=\cosh^{-1}\frac 53\approx 1.099\\
		d(P,Q)=\cosh^{-1}\left(1+\frac{2\cdot \frac 12}{(1-\frac 14)^2}\right) =\cosh^{-1}\frac{25}9 \approx 1.681
		\end{gather*}
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.3\linewidth}\vspace{-20pt}
		\flushright\includegraphics[scale=0.9]{models-dist4}
	\end{minipage}
	\goodbreak
	
	To find the interior angle $\theta$, implicitly differentiate the equation for the hyperbolic line $\lin{PQ}$:
	\[
		x^2+y^2-\frac 52x-\frac 52y+1=0 \implies \diffat[y]{x}{P}=\frac{4x-5}{5-4y}\bigg|_P=-\frac 35 \implies \theta=\tan^{-1}\frac 35\approx \ang{30.96}
	\]
	By symmetry, we have the same angle at $Q$. With a right-angle at $O$, we conclude that the angle sum is approximately $\Sigma_\triangle=\ang{151.93}$!\smallbreak
	As a sanity check, we compare data for $\triangle OPQ$ and the \emph{Euclidean} triangle with the same vertices
	\begin{center}
		\begin{tabular}{l||c|c}
			Property&Hyperbolic Triangle&Euclidean Triangle\\\hline\hline
			Edge lengths&$1.099:1.099:1.681$&$0.5:0.5:0.707$\\
			Relative edge ratios&$1:1:1.530$&$1:1:1.414$\\
			Angles&\ang{30.06}, \ang{30.96}, \ang{90}&\ang{45}, \ang{45}, \ang{90}%\\
			%Area&1.023&0.322
		\end{tabular}
	\end{center}
	The hyperbolic triangle has longer sides and a \emph{relatively} longer hypotenuse. Moreover, its side lengths do \emph{not} satisfy the Pythagorean relation $a^2+b^2=c^2$ (though $\cosh a\cosh b=\cosh c\ldots$).
\end{example}

\begin{minipage}[t]{0.65\linewidth}\vspace{-5pt}
	The next result is an exercise; it says that distance increases smoothly as one moves along a hyperbolic line.
	
	\begin{lemm}{}{hypdistwd}
		Fix $P$ and a hyperbolic line through $P$. Then the distance function $Q\mapsto d(P,Q)$ maps the set of points on one side of $P$ differentiably and bijectively onto the interval $(0,\infty)$.
	\end{lemm}
	
	The Lemma means that hyperbolic circles are well-defined and look like one expects: the circle of hyperbolic radius $\delta$ centered at $P$ is the set of points $Q$ such that $d(P,Q)=\delta$.
\end{minipage}
\hfill
	\begin{minipage}[t]{0.34\linewidth}\vspace{-5pt}
\flushright\includegraphics[scale=0.95]{hyper-circle}
\end{minipage}\medbreak

In the picture are several \textcolor{blue}{hyperbolic circles} and their \textcolor{red}{centers}; one has several of its \textcolor{Green}{radii} drawn. Observe how the centers are closer (in a Euclidean sense) to the boundary circle than one might expect: this is since hyperbolic distances measure greater the further one is from the origin.\smallbreak

In fact (Exercise \ref*{sec:hyp-models}.\ref{exs:circhypcirc}) hyperbolic circles in the Poincaré disk model are also Euclidean circles! Their hyperbolic radii moreover intersect the circles at right-angles, as we'd expect.


\begin{thm}{}{}
	The Poincaré disk is a model of hyperbolic geometry.
\end{thm}

\begin{proof}[Sketch Proof]
	A rigorous proof would require us to check the hyperbolic postulate and all Hilbert's axioms except Playfair. Instead we verify Euclid's postulates 1--4 and the hyperbolic postulate 5.
	\begin{enumerate}\itemsep0pt
	  \item Lemma \ref{lemm:hypline} says we can join any given points in the Poincaré disk by a unique segment.
	  \item A hyperbolic segment joins two points \emph{inside} the (open) Poincaré disk. The distance formula increases (Lemma \ref{lemm:hypdistwd}) unboundedly as $P$ moves towards the boundary circle, so we can always make a hyperbolic line longer.
	  \item Hyperbolic circles are defined above.
	  \item All right-angles are equal since the notion of angle is unchanged from Euclidean geometry.
	  \item The first picture on page \pageref{sec:hyp-models} shows multiple parallels!\hfill{\qedhere}
	\end{enumerate}
\end{proof}

\goodbreak



\boldsubsubsection{Other Models of Hyperbolic Space: non-examinable}

There are several other models of hyperbolic space. Here are three of the most common.%\vspace{-8pt}

\boldinline{Klein Disk Model} This is similar to the Poincaré disk, though lines are chords of the unit circle (`Euclidean' straight lines!) and the distance function is different:
\[
	d_K(P,Q) =\frac 12\nm{\ln\frac{\nm{P\Theta}\nm{Q\Omega}}{\nm{P\Omega}\nm{Q\Theta}}}
\]

\begin{minipage}[t]{0.69\linewidth}\vspace{0pt}
	where $\Omega,\Theta$ are where the chord $\smash[t]{\lin{PQ}}$ meets the boundary circle.\smallbreak
	The cost is that the notion of \emph{angle} is different. The picture shows perpendicularity: Given a \textcolor{red}{hyperbolic line} find the \textcolor{Green}{tangents} to where it meets the boundary circle. Any \textcolor{blue}{chord} whose extension passes through the \textcolor{Green}{intersection} of these tangents is perpendicular to the \textcolor{red}{original line}. Measuring other angles is difficult!
\end{minipage}
\hfill
\begin{minipage}[t]{0.3\linewidth}\vspace{-32pt}
	\flushright\includegraphics[scale=0.9]{models-klein}
\end{minipage}\medbreak

Gauss' famous \emph{theorem egregium} says that this problem is unavoidable; there is no model in which lines and angles both have the same meaning as in Euclidean geometry. 

%  If $H$ is a model of hyperbolic geometry, then its intrinsic curvature says that it is impossible to find an embedding $f:H\to\R^2$ which preserves \emph{both} the concepts of straight line and angle. Poincaré's model has nice angles but `bendy' lines; Klein's lines are `Euclidean straight' but his angle are ugly. The best we can do is to have one concept or the other: we cannot have both.\footnote{The same problem arises when trying to make a map of part of the Earth (another curved geometry). One can have maps which preserve distance or angle, but not both.}

\begin{minipage}[t]{0.69\linewidth}\vspace{0pt}
	\boldinline{Poincaré Half-plane Model}
	
	Widely used in complex analysis, the points comprise the upper half-plane $(y>0)$ in $\R^2$, while hyperbolic lines are verticals or semicircles centered on the $x$-axis
	\[
		x=\text{constant}\quad\text{or}\quad (x-a)^2+y^2=r^2
	\]
	and angles are the same as in Euclidean space. The expression for hyperbolic distance remains horrific! The picture shows several hyperbolic lines and a \textcolor{blue}{hyperbolic triangle.}
\end{minipage}
\hfill
\begin{minipage}[t]{0.3\linewidth}\vspace{0pt}
	\flushright\includegraphics{models-halfplane}
\end{minipage}



\boldinline{Hyperboloid Model}

Points comprise the upper sheet $(z\ge 1)$ of the hyperboloid $x^2+y^2=z^2-1$. A \textcolor{blue}{hyperbolic line} is the intersection of the hyperboloid with a plane through the origin. Isometries (congruence) can be described using matrix-multiplication and hyperbolic distance is relatively easy: given $P=(x,y,z)$ and $Q=(a,b,c)$, hyperbolic distance is

\begin{minipage}[t]{0.6\linewidth}\vspace{-10pt}
	\[
		d(P,Q)=\cosh^{-1}(cz-ax-by)
	\]
	Difficulties include working in three dimensions and the fact that angles are awkward.\smallbreak
	The relationship to the Poincaré disk is via projection. Place the disk in the $x,y$-plane centered at the origin and draw a \textcolor{Green}{line} through the disk and the point $(0,0,-1)$. The intersection of this line with the hyperboloid gives the correspondence.
\end{minipage}
\hfill
\begin{minipage}[t]{0.39\linewidth}\vspace{0pt}
	\flushright\href{http://www.math.uci.edu/~ndonalds/math161/hyper-plane.html}{\includegraphics[scale=0.8]{hyper-plane}}
\end{minipage}


\begin{exercises}
	Answer all questions within the Poincaré disk model.
	\begin{enumerate}
	  \item\begin{enumerate}
	    \item Find the equation of the hyperbolic line joining $P=(\frac 14,0)$ and $Q=(0,\frac 12)$.
	    \item Find the side lengths of the hyperbolic triangle $\triangle OPQ$ where $O=(0,0)$ is the origin.
	    \item The triangle in part (b) is right-angled at $O$. If $o,p,q$ represent the hyperbolic lengths of the sides opposite $O,P,Q$ respectively, check that the Pythagorean theorem $p^2+q^2=o^2$ is \emph{false.} Now compute $\cosh p\cosh q$: what do you observe?
	  \end{enumerate}
	  	
	  \item Let $P=\left(\frac 12,\sqrt{\frac 5{12}}\right)$ and $Q=\left(\frac 12,-\sqrt{\frac 5{12}}\right)$
	  \begin{enumerate}
	    \item Compute the hyperbolic distances $d(O,P)$, $d(O,Q)$ and $d(P,Q)$, where $O$ is the origin.
	    \item Compute the angle $\measuredangle POQ$.
		  \item Show that the hyperbolic line $\ell=\lin{PQ}$ has equation
			\[
				x^2-\frac{10}3x+y^2+1=0
			\]
	  	\item Calculate $\diff[y]{x}$ and hence show that a tangent vector to $\ell$ at $P$ is $\sqrt{15}\vi+7\vj$. Use this to compute $\measuredangle OPQ$.
		\end{enumerate} 
		
	  \item\label{exs:isorighthypextended} We extend Example \ref{ex:hypisosceles}. Let $c\in(0,1)$ and label $O=(0,0)$, $P=(c,0)$ and $Q=(0,c)$.
	  \begin{enumerate}
	    \item Compute the hyperbolic side lengths of $\triangle OPQ$.
	    \item Find the equation of the hyperbolic line joining $P=(c,0)$ and $Q=(0,c)$.
	    \item Use implicit differentiation to prove that the interior angles at $P$ and $Q$ measure $\tan^{-1}\frac{1-c^2}{1+c^2}$. What happens as $c\to 0^+$ and as $c\to 1^-$?
	  \end{enumerate}
		
		\item Let $0<r<1$ and find the hyperbolic side lengths and interior angles of the equilateral triangle with vertices $(r,0)$, $(-\frac r2,\frac{\sqrt 3r}2)$ and $(-\frac r2,-\frac{\sqrt 3r}2)$.What do you observe as $r\to 0^+$ and $r\to 1^-$?
		
		\item\label{exs:circhypcirc}\begin{enumerate}
	    \item Use the cosh distance formula to prove that the hyperbolic circle of hyperbolic radius $\rho=\ln 3$ and center $C=(\frac 12,0)$ in the Poincaré disk has \emph{Euclidean} equation
	    \[
	    	\left(x-\frac 25\right)^2+y^2=\frac 4{25}
	    \]
	    \item Prove that every hyperbolic circle in the Poincaré disk is in fact a Euclidean circle.
	  \end{enumerate}
		
		\item We sketch a proof of Lemma \ref{lemm:hypdistwd}. 
		\begin{enumerate}
		  \item Prove that $f(x)=\cosh^{-1}x=\ln(x+\sqrt{x^2-1})$ is strictly increasing on the interval $(1,\infty)$.
		  \item By part (a), it is enough to show that $\frac{\nm{PQ}^2}{1-\nm Q^2}$ increases as $Q$ moves away from $P$ along a hyperbolic line. Appealing to symmetry, let $P=(0,c)$ lie on the hyperbolic line with equation $x^2+y^2-2by+1=0$. Prove that
		  \[
		  	\frac{\nm{PQ}^2}{1-\nm Q^2}=\frac{(b-c)y+bc-1}{1-by}
		  \]
		  and hence show that this is an increasing function of $y$ when $c<y<\frac 1b$.
		\end{enumerate} 
	% For a difficult exercise, try to find the omega-points for the line $\overleftrightarrow{PQ}$ and see that you obtain the same expression for the distance.\footnote{Hint: $\Omega,\Theta$ have $x=\frac{4\pm\sqrt{34}}{10}$, $y=\frac{4\mp\sqrt{34}}{10}$\ldots}\goodbreak

	\end{enumerate}
\end{exercises}

\clearpage



\subsection{Parallels, Perpendiculars \& Angle-Sums}\label{sec:hypparallel}

\begin{minipage}[t]{0.65\linewidth}\vspace{-8pt}
	From now on, all examples will be illustrated within the Poincaré disk model. Recall (page \pageref{sec:hyp1}) that we may use anything from absolute geometry; as a sanity check, think through how the picture illustrates the following result.
	
	\begin{lemm}{}{hypperp}
		Through a point $P$ not on a line $\ell$ there exists a unique perpendicular to $\ell$. 
	\end{lemm}
	
	We now consider a major departure from Euclidean geometry.
\end{minipage}
\hfill
\begin{minipage}[t]{0.34\linewidth}\vspace{-28pt}
	\flushright\includegraphics[scale=0.75]{basic-perp}
\end{minipage}

% \begin{proof}
% Choose a point $A\in\ell$ and join $\cl{AP}$. If $\cl{AP}$ is perpendicular to $\ell$, we only need uniqueness.\par
% \begin{minipage}[t]{0.63\linewidth}\vspace{-3pt}
% Otherwise, $\ell$ is \emph{not tangent} to the \textcolor{blue}{circle} centered at $P$ with radius $\nm{AP}$. There therefore exists a second intersection point $B\in\ell$.\smallbreak
% Construct the \textcolor{Green}{circles} with radius $\nm{AB}$ centered at $A$ and $B$ respectively: these have two intersections $Q,R$. Let $\textcolor{orange}{m}=\lin{QR}$.\smallbreak
% Fhe following should be straightforward:
% \begin{itemize}\itemsep0pt
%   \item $m$ intersects $\ell$ at right-angles ($M$ in the picture)
%   \item $P\in m$
%   \item $M$ is the midpoint of $\cl{AB}$
% \end{itemize}
% To help, note that the blue and green arcs are radii of their respective circles, so we have several isosceles triangles\ldots 
% \end{minipage}\hfill\begin{minipage}[t]{0.36\linewidth}\vspace{0pt}
% \flushright\includegraphics[scale=0.9]{basic-perp}
% \end{minipage}\smallbreak
% For uniqueness, suppose we have two perpendiculars to $\ell$ through $P$ intersecting $\ell$ at distinct points $M,N$. Then $\triangle PMN$ has two right-angles which contradicts Saccheri--Legendre (Theorem \ref{thm:saccleg}).
% \end{proof}



\begin{thm}[lower separated=false, sidebyside, sidebyside align=top seam, sidebyside gap=0pt, righthand width=0.25\linewidth]{Fundamental Theorem of Parallels}{hyperfund}
	Given $P\not\in\textcolor{red}{\ell}$, drop the perpendicular $\cl{PQ}$. Then there exist precisely two \textcolor{blue}{parallel lines $m,n$} to $\ell$ through $P$ with the following properties:
	\begin{enumerate}\itemsep0pt
	  \item A \textcolor{Green}{ray} based at $P$ intersects $\ell$ if and only if it lies between $m$ and $n$ in the same fashion as $\ray{PQ}$.
	  \item $m$ and $n$ make congruent acute angles $\mu$ with $\ray{PQ}$.
	\end{enumerate}
	\tcblower
	\flushright\includegraphics[scale=0.8]{basic-parallels}
\end{thm}

\begin{defn}{}{limparallel}
	The lines $m,n$ are the \emph{limiting,} or \emph{asymptotic, parallels} to $\ell$ through $P$. Every other parallel is an \emph{ultraparallel.} The \emph{angle of parallelism} at $P$ relative to $\ell$ is the acute angle $\mu$.
\end{defn}

More generally, parallel lines $\ell,m$ are \emph{limiting} if they `meet' at an omega-point.\smallbreak


The proof depends crucially on ideas from analysis, particularly continuity \& suprema. As you read through, consider how everything \emph{except} the last line is valid in Euclidean geometry!
 
\begin{proof}
	Points $R\in\ell$ are in continuous bijective correspondence with the real numbers (Lemma \ref{lemm:hypdistwd}). It follows that we have a \emph{continuous increasing} function
	\[
		f:\R\to(-\ang{90},\ang{90})\quad\text{where}\quad f(r)=\measuredangle QPR
	\]
	By Saccheri--Legendre, $\pm\ang{90}\not\in\operatorname{range}f$. Since $\dom f=\R$ is an interval, the intermediate value theorem forces $\operatorname{range}f$ to be a \emph{subinterval} $I\subseteq(-\ang{90},\ang{90})$.\par
	
	\begin{minipage}[t]{0.71\linewidth}\vspace{-6pt}
		Given $R\in\ell$, transfer $\cl{QR}$ to the other side of $Q$ to obtain $S\in\ell$. By SAS, $\textcolor{Green}{\measuredangle QPS}=\textcolor{Green}{-\measuredangle QPR}$ whence $I=\operatorname{range}f$ is \emph{symmetric}: $\theta\in I\iff -\theta\in I$.\smallbreak
	Define $\mu:=\sup I\in(\ang{0},\ang{90}]$ to be the least upper bound; by symmetry, $\inf I=-\mu$. Let $m$ and $n$ be the lines making angles $\pm\mu$ respectively. Plainly every ray making angle $\theta\in(-\mu,\mu)$ intersects $\ell$.\smallbreak
	Suppose $m$ intersected $\ell$ at $M$. Let $\tilde M\in\ell$ lie on the other side of $M$ from $Q$. Since $f$ is increasing, we see that $\measuredangle QP\tilde M>\mu$, which contradicts $\mu=\sup I$. It follows that $m$ is parallel to $\ell$. Similarly $n\parallel\ell$ and we have part 1.
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.28\linewidth}\vspace{-8pt}
		\flushright\includegraphics[scale=1]{basic-parallels5}
	\end{minipage}
	\smallbreak
	Finally $m=n\Longleftrightarrow \mu=\ang{90}$. In such a case there would exist only one parallel to $\ell$ through $P$, contradicting the hyperbolic postulate.
\end{proof}
\goodbreak


The picture suggests a bijective relationship between $\mu$ and the perpendicular distance. Here it is; we postpone a simplified argument to Exercise \ref*{sec:hypparallel}.\ref{exs:angparallelism}; the full result follows from a discussion of omega-triangles in the next section.

\begin{cor}{}{parangleformula}
	The perpendicular distance $\delta=d(P,Q)$ and the angle of parallelism are related via
	\[
		\cosh\delta=\csc\mu\quad\text{or equivalently}\quad \smash[t]{\tan\frac{\mu}2}=e^{-\delta}
	\]
\end{cor}


\begin{examples}{}{}
	\exstart Let $\textcolor{red}{\ell}$ be the hyperbolic line $x^2+y^2-4x+1=0$.
	\begin{enumerate}\setcounter{enumi}{1}
		\begin{minipage}[t]{0.7\linewidth}\vspace{-5pt}
		  \item[]Intersect with $x^2+y^2=1$ to find $\Omega=\left(\tfrac 12,\tfrac{\sqrt 3}2\right)$ and $\Theta=\left(\tfrac 12,-\tfrac{\sqrt 3}2\right)$.\par
			By symmetry, the perpendicular from $P=(0,0)$ to $\ell$ has equation $y=0$ and results in $Q=(2-\sqrt 3,0)$.\smallbreak
			The limiting parallels through $P$ have equations $y=\pm\sqrt 3x$, from which the angle of parallelism is $\mu=\tan^{-1}\sqrt 3=\ang{60}$.\par
		  In accordance with Corollary \ref{cor:parangleformula}, we easily verify that
		\end{minipage}
		\hfill
		\begin{minipage}[t]{0.29\linewidth}\vspace{-25pt}
		  \flushright\includegraphics{basic-parallels4}
		\end{minipage}\par\vspace{-15pt}
		\[
			\delta=d(P,Q)=\ln\frac{1+(2-\sqrt 3)}{1-(2-\sqrt 3)}=\ln\sqrt 3 \leftrightsquigarrow e^{-\delta}=\frac 1{\sqrt 3}=\tan\frac{\mu}2
		\]
	  
		\begin{minipage}[t]{0.68\linewidth}\vspace{0pt}
		  \item We find the limiting parallels and the angle of parallelism when
			\[
				P=\left(-\frac 3{10},\frac 4{10}\right)\quad\text{and}\quad \textcolor{red}{x^2+y^2+2x+4y+1=0}
			\]
			First find the omega-points by intersecting with $x^2+y^2=1$:
			\[
				\Omega=(-1,0),\quad \Theta=\left(\frac 35,-\frac 45\right)
			\]
			Plainly $\textcolor{Green}{\overleftrightarrow{P\Theta}}$ is the diameter $y=-\frac 43x$ with slope $-\frac 43$.
		\end{minipage}
		\hfill
		\begin{minipage}[t]{0.31\linewidth}\vspace{0pt}
			\flushright\includegraphics{basic-parallels3}
		\end{minipage}\smallbreak
		For $\textcolor{blue}{\overleftrightarrow{P\Omega}}$, substitute into the usual expression $x^2+y^2-2ax-2by+1=0$ and implicitly differentiate:
		\[
			x^2+y^2+2x-\frac{13}8y+1=0\implies \diffat[y]{x}{P}=\frac{16(1+x)}{13-16y}\bigg|_P=\frac{16\cdot\frac 7{10}}{13-\frac{64}{10}}=\frac{56}{33}
		\]
		The angle of parallelism is \emph{half} that between the tangent vectors $\stwovec{-33}{-56}$ and $\stwovec 3{-4}$:
		\begin{align*}
			\mu&=\frac 12\cos^{-1}\frac{\stwovec{-33}{-56}\cdot\stwovec{3}{-4}}{\nm{\stwovec{-33}{-56}}\nm{\stwovec{3}{-4}}}
			=\frac 12\cos^{-1}\frac 5{13}\approx \ang{33.69}
		\end{align*}
		Corollary \ref{cor:parangleformula} can now be used to find the perpendicular distance $d(P,Q)=\ln\frac{3+\sqrt{13}}2$.\par
		Without the development of later machinery, it is \emph{very tricky} to compute $Q$. If you want a serious challenge, see if you can convince yourself that $Q=\left(\frac{93(-29+2\sqrt{117})}{1865}, \frac{26(-29+2\sqrt{117})}{1865}\right)$.
	\end{enumerate}
\end{examples}


\goodbreak


\boldsubsubsection{Angles in Triangles, Rectangles and the AAA Congruence}

We finish this section three important differences between hyperbolic and Euclidean geometry.

\begin{thm}{}{hyptriangle}
	In hyperbolic geometry:
	\begin{enumerate}\itemsep0pt
	  \item There are \textbf{no rectangles} (quadrilaterals with four right-angles). In particular, the summit angles of a Saccheri quadrilateral are acute.
	  \item The angles in a triangle sum to \textbf{strictly less} than \ang{180}.
	  \item (AAA congruence)\lstsp If the angles of $\triangle ABC$ and $\triangle DEF$ are congruent in pairs, then the triangles are \textbf{congruent} ($\triangle ABC\cong\triangle DEF$).
	\end{enumerate}
\end{thm}

Note that AAA is a \emph{congruence} theorem in hyperbolic geometry, not a \emph{similarity} theorem (compare with Theorem \ref{thm:aaasim}). Also revisit the observations on page \pageref{pg:absolute}. These results largely show that Euclid's arguments making use of the parallel postulate actually \emph{required} it! 


\begin{proof}
	Given a rectangle $\square ABCD$, reflect across $\cl{CD}$ (Exercise \ref*{sec:hyp1}.\ref{exs:saccherisplit}) and repeat to obtain an infinite family of congruent rectangles. Let $P\in\cl{CD}$ and drop perpendiculars to $R\in\cl{AB}$ and $C_1$ as shown.\smallbreak
	$\square PRBC$ is a rectangle: if not, then one of $\square ARPD$ or $\square PRBC$ would have angle sum exceeding \ang{360}, contradicting Saccheri--Legendre (Theorem \ref{thm:saccleg}). Similarly $\square DPC_1D_1$ is a rectangle.\smallbreak
	By Exercise \ref*{sec:hyp1}.\ref{exs:rectanglesplit}, $\textcolor{Magenta}{\ray{BP}}$ splits $\square PRBC$ into a pair of congruent triangles. In particular, $\textcolor{Magenta}{\ray{BP}}$ crosses $\cl{CD}$ at the \textcolor{orange}{same angle} as it leaves $B$. We find ourselves in the original configuration: the ray $\textcolor{Magenta}{\ray{BP}}$ emanates from the upper-right vertex of $\square DPC_1D_1$ at the \textcolor{orange}{same angle} as it does for $\square ABCD$!\smallbreak
	Iterate the process to obtain the picture, each time dropping the perpendicular from $P_k$ to $\cl{CD}$ to produce the \emph{equidistant} sequence $Q_1,Q_2,Q_3,\ldots$ Since $\cl{CD}$ is \emph{finite,} this eventually\footnotemark{} passes $D$: some $Q_n$ lies on the opposite side of $\lin{AD}$. It follows that $P_n\in\textcolor{Magenta}{\ray{BP}}$ does also, whence $\textcolor{Magenta}{\ray{BP}}$ intersects $\lin{AD}$.
	\begin{center}
		\includegraphics[scale=0.95]{basic-rect4}\vspace{-4pt}
	\end{center}
	Since $P\in\cl{CD}$ was generic, we see that any ray based at $B$ on the same side as $\cl{AD}$ intersects $\lin{AD}$. The angle of parallelism of $B$ with respect to $\lin{AD}$ is therefore \ang{90}, contradicting the hyperbolic postulate.\smallbreak
	Parts 2 and 3 are addressed in Exercises \ref{exs:triless180} and \ref{exs:aaacongproof}.
\end{proof}

\footnotetext{This is the Archimedean property from analysis: $a>b\Longrightarrow \exists n\in\N$ such that $nb>a$.}

\goodbreak


\begin{exercises}
	\exstart Prove the following in hyperbolic geometry (\emph{use Theorem \ref{thm:hyptriangle}}).\par\vspace{-2pt}
	\begin{enumerate}\setcounter{enumi}{1}
	  \item[]\begin{enumerate}
	    \item Two hyperbolic lines cannot have more than one common perpendicular.
	    \item\label{exs:saccherisummitcong} Saccheri quadrilaterals with congruent summits and summit angles are congruent.
	  \end{enumerate}
	  
	  \item Let $\ell$ be the line $x^2+y^2-4x+2y+1=0$ and drop a perpendicular from $O$ to $Q\in\ell$.
	  \begin{enumerate}
	    \item Explain why $Q$ has co-ordinates $(\smash{\frac 2{\sqrt 5}t,-\frac 1{\sqrt 5}t})$ for some $t\in(0,1)$.
	    \item Show that the hyperbolic distance $\delta=d(O,Q)$ of $\ell$ from the origin is $\ln\frac{1+\sqrt 5}2$.
	    \item $\Omega=(0,-1)$ is an omega-point for $\ell$. Compute the angle of parallelism $\mu=\measuredangle QO\Omega$ explicitly and check that $\cosh\delta=\csc\mu$.
		\end{enumerate}
		
	    
		\item\label{exs:angparallelism} 
		Suppose $P=(0,0)$ is the origin, let $0<r<1$ and $Q=(r,0)$. Also let $\ell$ be the hyperbolic line passing through $Q$ at right-angles to $\cl{PQ}$.
	  \begin{enumerate}
	    \item Find the equation of $\ell$ and prove that its limiting parallels through $P$ have equations
	    \[
	    	\pm 2ry=(1-r^2)x
	    \]
	    (\emph{Hint: what does symmetry tell you about the location of the Euclidean center of $\ell$?})
	    \item Let $\mu$ be the angle of parallelism of $P$ relative to $\ell$ and $\delta=d(P,Q)$ the hyperbolic distance. Prove that $\cosh\delta=\csc\mu$.\par
	    (\emph{Hint: $\csc^2\!\mu=1+\cot^2\!\mu=1+\frac 1{\tan^2\!\mu}=\ldots$})
	    \item By differentiating, verify the claim that $\delta$ and $\mu$ are bijectively related.
	  \end{enumerate}
	  
	  \item\label{exs:triless180} We work in \emph{absolute geometry}.
	  \begin{enumerate}
	    \begin{minipage}[t]{0.64\linewidth}\vspace{0pt}
	    \item Suppose $A$, $B$ and $P$ are non-collinear and drop the perpendicular from $P$ to $Q\in\overleftrightarrow{AB}$.\par
	    If $P$ lies between the perpendiculars $\ell,m$ to $\overleftrightarrow{AB}$ through $A$ and $B$, prove that $Q$ is interior to $\cl{AB}$.\par
	    (\emph{Hint: show that the other cases are impossible})
	    \item Suppose there exists a triangle with angle sum \ang{180}. Show that there exists a \emph{right-triangle} with angle sum \ang{180} and therefore a rectangle.
	  	\end{minipage}\hfill
	  	\begin{minipage}[t]{0.35\linewidth}\vspace{0pt}
	  		\flushright\includegraphics{basic-tri2}
	  	\end{minipage}\smallbreak
	  	(\emph{Since rectangles are impossible in hyperbolic geometry, this proves part 2 of Theorem \ref{thm:hyptriangle}})
	  \end{enumerate}
	  
	  
	  \item\label{exs:aaacongproof} We prove the AAA congruence theorem (Theorem \ref{thm:hyptriangle}, part 3).\par
	  Suppose $\triangle ABC$ and $\triangle DEF$ are \emph{non-congruent} but have angles congruent in pairs. WLOG assume $\cl{DE}<\cl{AB}$. By uniqueness of angle/segment transfer, there exist unique points $G\in\cl{AB}$ and $H\in\ray{AC}$ such that (SAS) $\triangle DEF\cong\triangle AGH$.\par
	  \begin{minipage}[t]{0.6\linewidth}\vspace{-5pt}
	  	The picture shows the three possible arrangements.
	  	\begin{enumerate}\itemsep0pt
	    	\item $H$ is interior to $\cl{AC}$.
	    	\item $H=C$.
	    	\item $C$ lies between $A$ and $H$.
	  	\end{enumerate}
	  	In each case, explain why we have a contradiction.
	   \end{minipage}\hfill\begin{minipage}[t]{0.39\linewidth}\vspace{-25pt}
	    \flushright\includegraphics[scale=0.95]{basic-aaa}
	   \end{minipage}
	\end{enumerate}
\end{exercises}


\clearpage



\subsection{Omega-triangles}

\begin{minipage}[t]{0.7\linewidth}\vspace{-5pt}
	Recall that limiting parallels (Definition \ref{defn:limparallel}) `meet' at an omega-point.
	
	\begin{defn}{}{}
		An \emph{omega-triangle} or \emph{ideal-triangle} is a `triangle' one or more of whose vertices is an omega-point. At least two of the sides of an omega-triangle form a pair of limiting parallels.
	\end{defn}
	
	The three types of omega-triangle depend on how many omega-points they have. In the picture, $\triangle PQ\Omega$ has one omega-point, $\triangle P\Omega\Theta$ has two and $\triangle \Omega\Theta\Xi$ three!
\end{minipage}
\hfill
\begin{minipage}[t]{0.28\linewidth}\vspace{-5pt}
	\flushright\includegraphics{omega-example}
\end{minipage}\smallbreak
Amazingly, many of the standard results of absolute geometry also apply to omega-triangles! The first can be thought of as the AAA congruence theorem where one `angle' is zero.

\begin{thm}{Angle-Angle Congruence for Omega-triangles}{}
	Suppose $\triangle AB\Omega$ and $\triangle PQ\Theta$ are omega-triangles, each with a single omega-point. If the angles are congruent in pairs
	\[
		\textcolor{Magenta}{\angle AB\Omega} \cong \textcolor{Magenta}{\angle PQ\Theta} \qquad \angle BA\Omega \cong\angle QP\Theta
	\]
	then the finite sides of each triangle are also congruent: $\cl{AB}\cong\cl{PQ}$.
\end{thm}

It doesn't really make sense to speak of the `infinite' sides, or the `angles' at omega-points, being congruent. However, if one defines congruence in terms of isometries (Section \ref{sec:hyperiso}), then this idea is more reasonable.

\begin{proof}
	Let $T\in\ray{AB}$ be such that $\cl{AT}\cong\cl{PQ}$. If $T=B$ we are done.\par
	\begin{minipage}[t]{0.7\linewidth}\vspace{-5pt}
		Otherwise, WLOG and for contradiction, assume $\cl{AB}<\cl{AT}$. The hypothesis asserts that the \textcolor{Magenta}{angles} at $B$ and $T$ are congruent.\smallbreak
		Let $M$ be the midpoint of $\textcolor{blue}{\cl{BT}}$ and drop the perpendicular to $N\in\lin{B\Omega}$.\smallbreak
		Let $L\in\lin{\Omega T}$ be on the opposite side of $\overleftrightarrow{BT}$ to $N$ such that $\textcolor{Green}{\cl{TL}}\cong \textcolor{Green}{\cl{BN}}$.\smallbreak
		We now have \textcolor{Green}{Side}-\textcolor{cyan}{Angle}-\textcolor{blue}{Side} data, whence $\triangle NBM\cong\triangle LTM$. The vertical angles at $M$ are congruent, whence $M$ lies on $\cl{LN}$ and we have a right-angle(!) at $L$.\smallbreak
		The angle of parallelism of $L$ relative to $\lin{B\Omega}$ is now $\angle NL\Omega=\ang{90}$, which contradicts Theorem \ref{thm:hyperfund}.\medbreak
		There are two other possible orientations:
		\begin{itemize}\itemsep0pt
		  \item $N$ could lie on the opposite side of $B$ from $\Omega$. In this case SAS is applied to the same triangles but with respect to the congruent \textcolor{Magenta}{magenta angles}.
		\end{itemize}\vspace{-12pt}
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.29\linewidth}\vspace{-5pt}
		\flushright\includegraphics{basic-ext3}
	\end{minipage}\par
	\begin{itemize}\parsep0pt
	  \item In the special case that $N=B$, the \textcolor{cyan}{cyan angles} are right-angles and the same contradiction appears: the angle of parallelism of $T$ with respect to $\lin{B\Omega}$ is \ang{90}.\qedhere
	\end{itemize}
\end{proof}

\goodbreak


\begin{thm}{Exterior Angle Theorem for Omega-Triangles}{exthyp}
	Suppose $\triangle PQ\Omega$ has a single omega-point and let $P*Q*R$. Then $\textcolor{orange}{\angle RQ\Omega}>\textcolor{Magenta}{\angle QP\Omega}$.
\end{thm}

\begin{tcolorbox}[proofstyle, lower separated=false, sidebyside, sidebyside align=top seam, sidebyside gap=0pt, righthand width=0.27\linewidth]
	\emph{Proof.}\quad We show that the two other cases are impossible.
	\begin{description}
	  \item[\normalfont ($\textcolor{orange}{\angle RQ\Omega}\cong\textcolor{Magenta}{\angle QP\Omega}$)] This is the contradictory arrangement described in the previous proof: $P=T,Q=B,R=A$, and the \textcolor{Magenta}{magenta angles} cannot be congruent.
		\item[\normalfont ($\textcolor{orange}{\angle RQ\Omega}<\textcolor{Magenta}{\angle QP\Omega}$)] Transfer the \textcolor{Magenta}{latter} to $Q$ to produce a ray $\ray{QX}$ \emph{interior} to $\angle PQ\Omega$ with $\textcolor{Green}{\angle RQX}\cong \textcolor{Magenta}{\angle QP\Omega}$.\par
	Since $\lin{Q\Omega}$ is a limiting parallel to $\lin{P\Omega}$, the Fundamental Theorem says that $\ray{QX}$ intersects $\lin{P\Omega}$ at some point $Y$.\par
	We now have $\triangle PQY$ contradicting the standard exterior angle theorem ($\textcolor{Green}{\angle RQY}\cong \textcolor{Magenta}{\angle QPY}$).
	\end{description}
	\tcblower
	\flushright\includegraphics{basic-ext4}\\\hfil\qedsymbol
\end{tcolorbox}

The final congruence theorem is an exercise based on the previous picture.

\begin{cor}{Side-Angle Congruence for Omega-triangles}{}
	Suppose $\triangle PQ\Omega$ and $\triangle AB\Theta$ have a single omega-point. If $\textcolor{Magenta}{\angle QP\Omega} \cong\angle BA\Theta$ and $\textcolor{blue}{\cl{PQ}}\cong\cl{AB}$ then $\angle PQ\Omega \cong\angle AB\Theta$.
\end{cor}

A triangle with one omega-point only has three pieces of data: two finite angles and one finite edge. The AA and SA congruence theorems say that two of these determine the third.

\boldsubsubsection{Other observations}

\emph{Pasch's Axiom}:\quad Versions of this are \emph{theorems} for omega-triangles.
\begin{itemize}
  \item If a line crosses a side of an omega-triangle and does not pass through any vertex (including $\Omega$), then it must pass through exactly one of the other sides.
  \item (\emph{Omega Crossbar Thm})\lstsp If a line passes through an interior point and exactly one vertex (including $\Omega$) of an omega-triangle, then it passes through the opposite side. This is partly embedded in the proof of Theorem \ref{thm:exthyp}.
\end{itemize}


\emph{Perpendicular Distance and the Angle of Parallelism}:\quad Applied to right-angled omega-triangles, the AA and SA theorems prove that the angle of parallelism is a bijective function of the perpendicular distance. Moreover, by transferring the right-angle to the positive $x$-axis and the other vertex to the origin, we obtain the arrangement in Exercise \ref*{sec:hypparallel}.\ref{exs:angparallelism}, thus completing the proof of Corollary \ref{cor:parangleformula}.


% \begin{thm}[Crossbar for omega-triangles]
% If $\triangle PQ\Omega$ is an omega-triangle and a line $\ell$ passes through one of the vertices (including $\Omega$) and an interior point of the triangle, then it also passes through the opposite side.
% \end{thm}
% 
% \begin{proof}
% There are two cases.
% \begin{enumerate}
%   \item If $\ell$ passes through $P$ and an interior point, then it must intersect $\cl{P\Omega}$ by an argument similar to Theorem \ref{thm:hyperfund}.
%   \item Suppose that $\ell$ passes through $\Omega$ and an interior point $I$. Then $\ell=\overleftrightarrow{I\Omega}$ is a limiting parallel to both $\cl{P\Omega}$ and $\cl{Q\Omega}$. By part 1, the line $\overleftrightarrow{PI}$ meets $\cl{Q\Omega}$ at a point $J$. The fact that $\ell$ crosses $\cl{PQ}$ is now a consequence of Pasch's axiom for $\triangle PQJ$.
%   \hfill\qedhere
% \end{enumerate}
% \end{proof}



\begin{exercises}
	\exstart Let $\triangle PQ\Omega$ be an omega-triangle. Prove that $\measuredangle PQ\Omega+\measuredangle QP\Omega< \ang{180}$
	\begin{enumerate}\setcounter{enumi}{1}
	  \item Let $\ell$ and $m$ be limiting parallels. Explain why they cannot have a common perpendicular.
	  
	  \item Prove the Side-Angle congruence theorem for omega-triangles with one omega-point.
	  
	  \item What would an `omega-triangle' look like in Euclidean geometry? Comment on the three results in this section: are they still true?
	\end{enumerate}
\end{exercises}

\clearpage

	

\subsection{Area and Angle-defect}\label{sec:hyparea}

In this section we consider one of the triumphs of Johann Lambert: the relationship between the sum of the angles in a triangle and its \emph{area.} We start with a loose axiomatization of area as a relative measure. Until explicitly stated otherwise, we work in \emph{absolute geometry.}

\begin{description}
	\item[Axiom I] Two geometric figures have the same area if and only if they may be sub-divided into finitely many pairs of mutually congruent triangles.\footnote{To allow infinitely many infinitesimal sub-triangles would require ideas from calculus and complicate our discussion.}
	\item[Axiom II] The area of a triangle is positive.
	\item[Axiom III] The area of a union of disjoint figures is the sum of the areas of the figures.
\end{description}

\begin{defn}{Angle defect}{}
	Let $\Sigma_\triangle$ be the sum of the angles in a triangle. Measured in radians, the \emph{angle-defect} of $\triangle$ is $\pi-\Sigma_\triangle$.
\end{defn}

Since triangles in absolute geometry have $\Sigma_\triangle\le\pi$ (Theorem \ref{thm:saccleg}), it follows that
\[
	0\le\pi-\Sigma_\triangle\le\pi
\]
In Euclidean geometry the defect is always zero, while in hyperbolic geometry the defect is strictly positive (Theorem \ref{thm:hyptriangle}). A `triangle' with three omega-points would have defect $\pi$.

\begin{minipage}[t]{0.74\linewidth}\vspace{0pt}
	\begin{lemm}{}{}
		Angle-defect is additive: If a triangle is split into two sub-triangles, then the defect of the whole is the sum of the defects of the parts.
	\end{lemm}
	
	This is immediate from the picture:
	\[
		\left[\pi-(\alpha+\gamma+\epsilon)\right]+\left[\pi-(\beta+\delta+\zeta)\right]=\pi-(\alpha+\beta+\gamma+\delta)
	\]
	since $\epsilon+\zeta=\pi$. Notice that angle-\emph{sum} is not additive!
\end{minipage}
\hfill
\begin{minipage}[t]{0.25\linewidth}\vspace{-15pt}
	\flushright\includegraphics{area-defect}
\end{minipage}



\begin{thm}{Area determines angle-sum in \emph{absolute geometry}}{areatoanglesum}
	If triangles have the same area, then their angle-sums are identical.
\end{thm}

Of course this trivial in Euclidean geometry where all triangles have the same angle-sum!

\begin{proof}
	The lemma provides the induction step: if $\triangle_1$ and $\triangle_2$ have the same area, then their interiors are disjoint unions of a finite collection of mutually congruent triangles:
	\[
		\triangle_1=\bigcup_{k=1}^n\triangle_{1,k}\quad\text{and}\quad \triangle_2=\bigcup_{k=1}^n\triangle_{2,k}\quad\text{where}\quad \triangle_{1,k}\cong\triangle_{2,k}
	\]
	Each pair $\triangle_{1,k},\triangle_{2,k}$ has the same angle-defect, whence the angle-defects of $\triangle_1$ and $\triangle_2$ are equal:
	\[
		\operatorname{defect}(\triangle_1)=\sum_{k=1}^n\operatorname{defect}(\triangle_{1,k}) =\sum_{k=1}^n\operatorname{defect}(\triangle_{2,k}) =\operatorname{defect}(\triangle_2)\tag*{\qedhere}
	\]
\end{proof}

\goodbreak


\boldsubsubsection{Angle-sum determines area in \emph{hyperbolic geometry}}

The converse in hyperbolic geometry relies on a beautiful and reversible construction relating triangles and Saccheri quadrilaterals. The construction itself is valid in absolute geometry, though the ultimate conclusion that angle-sum determines area is not. If the initial discussion seems difficult, pretend you are in Euclidean geometry and think about \emph{rectangles.}

\begin{lemm}{}{quadtricorr}
	\exstart Given $\triangle ABC$, choose a side $\cl{BC}$. Bisect the remaining sides at $E,F$ and drop perpendiculars from $A$, $B$, $C$ to $\lin{EF}$. Then $HICB$ is a Saccheri quadrilateral with base $\cl{HI}$.\vspace{-5pt}
	\begin{enumerate}\setcounter{enumi}{1}
	  \item Conversely, given a Saccheri quadrilateral $HICB$ with summit $\cl{BC}$, let $A$ be any point such that $\lin{HI}$ bisects $\cl{AB}$ at $E$. Then the intersection $F=\lin{HI}\cap\cl{AC}$ is the midpoint of $\cl{AC}$.
	\end{enumerate}
	\begin{minipage}[t]{0.6\linewidth}\vspace{-5pt}
	Both constructions yield the same picture and the following conclusions:\vspace{-5pt}
	  \begin{itemize}\itemsep0pt
	    \item The triangle and quadrilateral have equal area.
	    \item The sum of the summit angles of the quadrilateral equals the angle sum of the triangle.
	  \end{itemize}
	  We chose $\cl{BC}$ to be the longest side of $\triangle ABC$---this isn't necessary, though it helpfully forces $E,F$ to lie between $H,I$.
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.39\linewidth}\vspace{-15pt}
		\flushright\includegraphics[scale=0.95]{area-saccheri4}
	\end{minipage}
\end{lemm}


\begin{proof}
	\begin{enumerate}
	  \item Two applications of the SAA congruence (follow the arrows!) tell us that\vspace{-3pt}
	  \[
	  	\triangle BEH\cong\triangle AEG\text{ \ and \ }\triangle CFI\cong\triangle AFG
	  \]
	  \begin{minipage}[t]{0.6\linewidth}\vspace{-11pt}
		  We conclude that $\textcolor{red}{\cl{BH}\cong\cl{AG}\cong\cl{CI}}$ whence $HICB$ is a Saccheri quadrilateral. The area and angle-sum correspondence is immediate from the picture.
		  \item Suppose the midpoint of $\cl{AC}$ were at $J\neq F$. By part 1, we may create a new Saccheri quadrilateral with summit $\cl{BC}$ using the midpoints $E,J$.\smallbreak
		  The perpendicular bisector of $\cl{BC}$ bisects the bases of both Saccheri quadrilaterals (Lemma \ref{lemm:saccheribasic}), creating $\triangle EUV$ with two right-angles: contradiction.
		\end{minipage}
		\hfill
		\begin{minipage}[t]{0.39\linewidth}\vspace{-22pt}
			\flushright\includegraphics[scale=0.95]{area-saccheri5}\qedhere
		\end{minipage}		
	\end{enumerate}
\end{proof}

We now prove a special case of the main result.

\begin{lemm}{}{anglesumarea}
	Suppose \emph{hyperbolic} triangles $\triangle ABC$ and $\triangle PQR$ have congruent sides $\cl{BC}\cong\cl{QR}$ and the same angle-sum. Then the triangles have the same area.
\end{lemm}


\begin{proof}
	Construct the quadrilaterals corresponding to $\triangle ABC$ and $\triangle PQR$ with summits $\cl{BC}\cong\cl{QR}$. These have congruent summits \emph{and} summit angles: by Exercise \ref*{sec:hypparallel}.\ref{exs:saccherisummitcong} they are congruent.
\end{proof}

The final observation is what makes this special to \emph{hyperbolic} geometry. In the Euclidean case, Saccheri quadrilaterals are \emph{rectangles}, and congruent summits do not force congruence of the remaining sides.\goodbreak

\begin{thm}{}{arealemm2}
	In hyperbolic geometry, if $\triangle ABC$ and $\triangle PQR$ have the same angle-sum then they have the same area.
\end{thm}

\begin{proof}
	If the triangles have a pair of congruent edges, the previous result says we are done. Otherwise, we use Lemma \ref{lemm:quadtricorr} to create a new triangle $\triangle LBC$ which matching the same Saccheri quadrilateral as $\triangle ABC$.\smallbreak
	WLOG suppose $\nm{AB}<\nm{PQ}$ and construct the Saccheri quadrilateral with summit $\cl{BC}$. Select $K$ on $\lin{EF}$ such that $\nm{BK}=\frac 12\nm{PQ}$ and extend such that $K$ is the midpoint of $\cl{BL}$.\par
	\begin{minipage}[t]{0.6\linewidth}\vspace{0pt}
		\begin{itemize}
		  \item By Lemma \ref{lemm:quadtricorr},
		  \[\operatorname{Area}(\triangle LBC)=\operatorname{Area}(HICB)=\operatorname{Area}(\triangle ABC)\]
		  \item By Theorem \ref{thm:areatoanglesum}, $\triangle LBC$ has the same angle-sum as $\triangle ABC$ and thus $\triangle PQR$.
		  \item $\triangle LBC$ and $\triangle PQR$ share a congruent side ($\cl{LB}\cong\cl{PQ}$) and have the same angle-sum. Lemma \ref{lemm:anglesumarea} says their areas are equal.
		\end{itemize}
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.39\linewidth}\vspace{-12pt}
		\flushright\includegraphics{area-saccheri9}\qedhere
	\end{minipage}
\end{proof}

Since both area and angle-\emph{defect} are additive, we immediately conclude:

\begin{cor}{}{hypareaangle}
	The angle-defect of a hyperbolic triangle is an additive function of its area. By normalizing the definition of area,\footnotemark{} we may conclude that
	\[
		\pi-\Sigma_\triangle=\operatorname{Area}\triangle
	\]
\end{cor}

\footnotetext{
	We have really only proved that $\pi-\Sigma_\triangle$ is proportional to $\operatorname{Area}\triangle$. However, it can be seen that these quantities are equal if we use the area measure arising naturally from the hyperbolic distance function (see page \pageref{pg:hypareaext}).\smallbreak
 	Corollary \ref{cor:hypareaangle} is a special case of the famous Gauss--Bonnet theorem from differential geometry: for any triangle on a surface with Gauss curvature $K$, we have
	\[
		\Sigma_\triangle-\pi=\iint_\triangle K\,\dA
	\]
	We've now met all three special constant-curvature examples of this:
	\begin{description}
		\item[Euclidean space] is \emph{flat} ($K=0$) so the angle-defect is always zero.
		\item[Hyperbolic space] has \emph{constant negative curvature} $K=-1$, whence $\iint_\triangle\dA=-(\Sigma_\triangle-\pi)$ is the angle-defect.
		\item[Spherical geometry] A sphere of radius 1  has \emph{constant positive curvature} $K=1$ and $\iint_\triangle\dA$ is the angle-\emph{excess} $\Sigma_\triangle-\pi$. 
	\end{description}
}

Note finally how the AAA congruence (Theorem \ref{thm:hyptriangle}, part 3) is related to the corollary:
\[
	\begin{array}{ccc}
		\triangle ABC\cong \triangle DEF & \overset{\text{AAA}}{\iff} & \text{angles congruent in pairs}\\[5pt]
		\Downarrow & & \Downarrow\\
		\text{equal area} & \overset{\text{Cor \ref{cor:hypareaangle}}}{\iff} & \text{same angle-defect}
	\end{array}
\]
	
	\goodbreak

\begin{example*}{\ref{ex:hypisosceles}, cont}{}
	The isosceles right-triangle with vertices $O$, $P=(\frac 12,0)$ and $Q=(0,\frac 12)$ has angle-sum and area
	\[
		\frac\pi 2+2\tan^{-1}\frac 35\approx \ang{151.93}\implies \operatorname{area}=\pi-\left(\frac\pi 2+2\tan^{-1}\frac 35\right) =\frac\pi 2-2\tan^{-1}\frac 35\approx 0.490
	\]
	A Euclidean triangle with the same vertices has area $\frac 12\cdot\frac 12\cdot\frac 12=\frac 18=0.125$.\par
	
	\begin{minipage}[t]{0.7\linewidth}\vspace{0pt}
		Generalizing this (Exercise \ref*{sec:hyp-models}.\ref{exs:isorighthypextended}), the triangle with vertices $O,P=(c,0)$ and $Q=(0,c)$ has area
		\[
			\pi-\left(\frac\pi 2+2\tan^{-1}\frac{1-c^2}{1+c^2}\right)=\frac\pi 2-2\tan^{-1}\frac{1-c^2}{1+c^2}
		\]
		As expected, $\lim\limits_{c\to 0^+}\text{area}(c)=0$. In the other limit, the triangle becomes an omega-triangle with two omega-points and $\lim\limits_{c\to 1^-}\text{area}(c)=\frac\pi 2$: an infinite `triangle' with finite `area'!
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.29\linewidth}\vspace{0pt}
		\flushright
		\begin{tabular}{c@{}}
			\includegraphics{area-iso}\\
			The limit $c\to 1^-$
		\end{tabular}
	\end{minipage}
\end{example*}\vfil

Our discussion in fact provides an explicit method for cutting a triangle into sub-triangles and rearranging its pieces to create a triangle with equal area.

\begin{center}
	\includegraphics{area-saccheri10}\qquad\qquad\includegraphics{area-saccheri8}
\end{center}

Suppose $\textcolor{red}{\triangle_1}$ and $\textcolor{Green}{\triangle_2}$ have equal area and construct the quadrilaterals $\textcolor{red}{\cS_1}$ and $\textcolor{Green}{\cS_2}$. Let $L,K$ be chosen so that $\textcolor{blue}{\cl{BL}\cong\cl{QR}}$ and $K$ is the midpoint of $\textcolor{blue}{\cl{BL}}$. We now have:
\begin{itemize}
  \item $\textcolor{red}{\triangle_1}, \textcolor{Green}{\triangle_2}, \textcolor{blue}{\triangle_3}, \textcolor{red}{\cS_1}, \textcolor{Green}{\cS_2}, \textcolor{blue}{\cS_3}$ have the same area.
  \item The summit angles of $\textcolor{red}{\cS_1}, \textcolor{Green}{\cS_2}, \textcolor{blue}{\cS_3}$ are congruent (half the angle-sum of each triangle).
  \item $\textcolor{Green}{\cS_2}, \textcolor{blue}{\cS_3}$ are \emph{congruent} since they have congruent summits and summit angles.
\end{itemize}

We can now follow the steps in Lemma \ref{lemm:quadtricorr} to transform $\textcolor{red}{\triangle_1}$ to $\textcolor{Green}{\triangle_2}$:
\[
	\textcolor{red}{\triangle_1}\to \textcolor{red}{\cS_1}\to \textcolor{blue}{\triangle_3}\to \textcolor{blue}{\cS_3}\cong \textcolor{Green}{\cS_2}\to \textcolor{Green}{\triangle_2}
\]
where each arrow represents cutting off two triangles and moving them. Indeed this works even for triangles in Euclidean geometry!

\goodbreak


\begin{exercises}
	\exstart Use Corollary \ref{cor:hypareaangle} to find the area of the hyperbolic triangle with given vertices. Your answers to exercises from Section \ref{sec:hyp-models} should supply the angles!
	\begin{enumerate}\setcounter{enumi}{1}
	  \item[]\begin{enumerate}
	    \item $O=(0,0)$, $P=(\frac 12,\sqrt{\frac 5{12}})$ and $Q=(\frac 12,-\sqrt{\frac 5{12}})$.
	    \item $O=(0,0)$, $P=(\frac 14,0)$, $Q=(0,\frac 12)$.
	    \item $P=(r,0)$, $Q=\left(-\frac r2,\frac{\sqrt{3}r}2\right)$, $R=\left(-\frac r2,-\frac{\sqrt{3}r}2\right)$ where $0<r<1$.
		\end{enumerate}
		
		\item In the proof of Theorem \ref{thm:arealemm2}, explain why we can find $K$ such that $\nm{BK}=\frac 12\nm{PQ}$. 
		
   
	  \item Show that there is no finite triangle in hyperbolic geometry that achieves the maximum area bound $\pi$.\par
	  (Hard!) For a challenge, try to prove that omega-triangles also satisfy the angle-defect formula: Area $=\pi-\Sigma_\triangle$, so that only triangles with three omega-points have maximum area.
	
		\item Let $\Omega_1,\ldots,\Omega_n$ be $n$ distinct omega-points arranged counter-clockwise around the boundary circle of the Poincaré disk. A region is bounded by the $n$ hyperbolic lines
		\[
			\overleftrightarrow{\Omega_1\Omega_2},\quad \overleftrightarrow{\Omega_2\Omega_3},\quad\ldots,\quad\overleftrightarrow{\Omega_n\Omega_1}
		\]
		What is the area of the region? Hence argue that the `area' of hyperbolic space is infinite.
	  
	  \item An omega-triangle has vertices $O=(0,0)$, $\Omega=(1,0)$ and $P=(0,h)$ where $h>0$.
	  \begin{enumerate}
	    \item Prove that the hyperbolic segment $\cl{P\Omega}$ is an arc of a circle with equation
	    \[
	    	(x-1)^2+(y-k)^2=k^2
	    \]
	    for some $k>0$.
	    \item Prove that the area of $\triangle OP\Omega$ is given by
			\[
				A(h)=\sin^{-1}\dfrac{2h}{1+h^2}
			\]
		\end{enumerate}
		
		
		\item Suppose two Saccheri quadrilaterals in hyperbolic geometry have the same area and congruent summits. Prove that the quadrilaterals are congruent.
	
	\end{enumerate}
\end{exercises}

\clearpage




\subsection{Isometries and Calculation}\label{sec:hyperiso}

There are (at least!) two major issues in our approach to hyperbolic geometry.

\begin{description}
	\item[Calculations are difficult] In analytic (Euclidean) geometry we typically choose the origin and orient axes to ease calculation. We'd like to do the same in hyperbolic geometry.
	\item[We assumed too much] We defined \emph{distance, angle} and \emph{line} separately, but these concepts are \emph{not independent}! In Euclidean geometry, the distance function, or \emph{metric,} defines angle measure via the dot product,%
	\footnote{%
		Writing $\nm{\vu}=\nm{PQ}$ for the length of a line segment, we see that for any $\vu,\vv$,
		\[
			\vu\cdot\vv=\frac 12\left(\nm{\vu+\vv}^2-\nm\vu^2-\nm\vv^2\right)
		\]
		so that the metric defines the dot product. Now define angle measure via $\vu\cdot\vv=\nm\vu\nm\vv\cos\theta$.
	}%
	and (with some calculus) the arc-length of any curve. One then proves that the paths of shortest length (\emph{geodesics}) are straight lines: the metric \emph{defines} the notion of line!
\end{description}

Isometries provide a related remedy for these issues. To describe these it is helpful to use an alternative definition of the Poincaré disk and its distance function.

\begin{defn}[lower separated=false, sidebyside, sidebyside align=top seam, sidebyside gap=0pt, righthand width=0.3\linewidth]{}{hypdist2}
	The \emph{Poincaré disk} is the set $D:=\{z\in\C:\nm z<1\}$ equipped with the distance function
	\[
		d(z,w):=\nm{\ln\frac{\nm{z-\Omega}\nm{w-\Theta}}{\nm{z-\Theta}\nm{w-\Omega}}}
	\]
	where $\Omega,\Theta$ are the omega-points for the hyperbolic line through $z,w$ (defined as circlular arcs intersecting the boundary perpendicularly).
	\tcblower
	\flushright\includegraphics[scale=0.95]{isom-dist}
\end{defn}

We'll see shortly (Corollary \ref{cor:hypcossinerule}) that this is the same as the original cosh formula (page \pageref{lemm:distformula}); it is already easy to check that $d(z,0)=\ln\frac{1+\nm z}{1-\nm z}$ as in Lemma \ref{lemm:distformula} (if $w=0$, then $\Omega,\Theta=\pm\frac z{\nm z}$).\par
For candidate isometries we need functions $f:D\to D$ for which $d\bigl(f(z),f(w)\bigr)=d(z,w)$. These follow from some standard results of complex analysis that we state without proof.


\begin{thm}{Möbius/fractional-linear transformations}{mobius}
	If $a,b,c,d\in\C$ and $ad-bc\neq 0$, then the function $f(z)=\tfrac{az+b}{cz+d}$ has the following properties:
	\begin{enumerate}
	  \item (Invertibility)\lstsp $f:\C\cup\{\infty\}\to \C\cup\{\infty\}$ is bijective, with inverse $f^{-1}(z)=\tfrac{dz-b}{-cz+a}$.
	  \item (Conformality)\lstsp If curves intersect, then their images under $f$ intersect at the same angle.
	  \item (Line/circle preservation)\lstsp Every line/circle\footnotemark{} is mapped by $f$ to another line/circle.
	  \item(Cross-ratio preservation)\lstsp Given distinct $z_1,z_2,z_3,z_4$, we have
		\[
			\frac{\big(f(z_1)-f(z_2)\big)\big(f(z_3)-f(z_4)\big)}{\big(f(z_2)-f(z_3)\big)\big(f(z_4)-f(z_1)\big)} =\frac{(z_1-z_2)(z_3-z_4)}{(z_2-z_3)(z_4-z_1)}
		\]
	\end{enumerate}
\end{thm}

\footnotetext{In $\C\cup\{\infty\}$ a line is just a circle containing $\infty$!}


\goodbreak

The isometries of the Poincaré disk are a subset of the Möbius transformations.

\begin{thm}{}{hypisomclass}
	The \emph{orientation-preserving\footnotemark{} isometries} of the Poincaré disk have the form
	\[
		f(z)=e^{i\theta}\frac{\alpha-z}{\cl\alpha z-1}\quad\text{where $\nm\alpha<1$ and $\theta\in[0,2\pi)$}\tag{$\ast$}
	\]
	All isometries can be found by composing $f$ with complex conjugation (reflection in the real axis).
\end{thm}

\footnotetext{If $C$ is to the left of $\ray{AB}$, then $f(C)$ is to the left of $\ray{f(A)f(B)}$. This is the usual `right-hand rule.'} 


Referring to the properties in Theorem \ref{thm:mobius}:
\begin{enumerate}\itemsep0pt
  \item The isometries are precisely the set of Möbius transformations which map $D$ bijectively to itself; omega-points are also mapped to omega-points.
  \item Isometries preserve angles.
  \item The class of hyperbolic lines is preserved: any circle or line intersecting the unit circle at right-angles is mapped to another such (angle-preservation is used here). 
  \item If $\Omega,\Theta$ are the omega-points on $\lin{zw}$, then (by 2 and 3), $f(\Omega)$ and $f(\Theta)$ are the omega-points for the hyperbolic line through $f(z),f(w)$. Preservation of the cross-ratio says that $f$ is an isometry:
  \[
  	d(f(z),f(w))=\nm{\ln\frac{\nm{f(z)-f(\Omega)}\nm{f(w)-f(\Theta)}}{\nm{f(z)-f(\Theta)}\nm{f(w)-f(\Omega)}}}= \nm{\ln\frac{\nm{z-\Omega}\nm{w-\Theta}}{\nm{z-\Theta}\nm{w-\Omega}}}=d(z,w)
  \]
\end{enumerate}

How does this help us compute? The isometry ($\ast$) moves $\alpha$ to the origin, where calculating distances and angles is easy! %; one can then choose $\theta$ to orient whichever direction you like along the positive $x$-axis\ldots


\begin{example}{}{}
	Let $P=\frac 12$ and $Q=\frac 23+\frac{\sqrt 2}3i$. Move $P$ to the origin using\par
	\begin{minipage}[t]{0.74\linewidth}\vspace{-8pt}
		an isometry\footnotemark{} with $\alpha=P$:
% 		\begin{gather*}
%  			f(z)=e^{i\theta}\frac{\alpha-z}{\cl\alpha z-1}=e^{i\theta}\frac{1-2z}{z-2} \implies f(P)=O\\
%  			f(Q)=e^{i\theta}\frac{1-\frac 43-\frac{2\sqrt 2}3i}{\frac 23-2+\frac{\sqrt 2}3i} =-\frac{1+2\sqrt 2i}{-4+\sqrt 2i}e^{i\theta} =\frac{i}{\sqrt 2}e^{i\theta}
% 		\end{gather*}
% 		Choosing $e^{i\theta}=-i$ places $f(Q)=\frac 1{\sqrt 2}$ on the positive $x$-axis. 
		\begin{gather*}
 			f(z)=\frac{\alpha-z}{\cl\alpha z-1} =\frac{1-2z}{z-2} \implies f(P)=O\\
 			f(Q)=\frac{1-\frac 43-\frac{2\sqrt 2}3i}{\frac 23-2+\frac{\sqrt 2}3i} =-\frac{1+2\sqrt 2i}{-4+\sqrt 2i} =\frac{i}{\sqrt 2}
		\end{gather*}
		Let us compare distances:
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.25\linewidth}\vspace{-20pt}
		\flushright\includegraphics{calc-triangle3}
	\end{minipage}\par\vspace{-4pt}
	\begin{gather*}
		d\bigl(f(P),f(Q)\bigr) = \ln\frac{1+\nm{f(Q)}}{1-\nm{f(Q)}} =\ln\frac{1+\frac 1{\sqrt 2}}{1-\frac 1{\sqrt 2}}=\ln\frac{\sqrt 2+1}{\sqrt 2-1}=\ln(3+2\sqrt 2) \tag{Definition \ref{defn:hypdist2}}\\
		\begin{aligned}
			d(P,Q)&=\cosh^{-1}\left(1+\frac{2\nm{PQ}^2}{(1-\nm P^2)(1-\nm Q^2)}\right) =\cosh^{-1}\left(1+\frac{\frac 24}{(1-\frac 14)(1-\frac 23)}\right)\\
			&=\cosh^{-1}3=\ln(3+\sqrt{3^2-1})=\ln(3+2\sqrt 2) =d\bigl(f(P),f(Q)\bigr)
		\end{aligned}
	\end{gather*}
	If we trust the original cosh-formula (page \pageref{lemm:distformula}), then the points really are the same distance apart! Indeed the hyperbolic segment \textcolor{red}{$\cl{PQ}$} %(with equation $x^2+y^2-\frac 52x+1=0$) 
	has been transformed by $f$ to a segment \textcolor{Green}{$\cl{f(P)f(Q)}$} of the $y$-axis.
\end{example}

\footnotetext{We could also include a rotation ($e^{i\theta}=-i$) to move $f(Q)$ to the positive $x$-axis, but there is no real benefit.}

\goodbreak

Recall (e.g.,{} Example \ref{ex:hypisosceles}) how we previously computed angles. Isometries make this \emph{much} easier. 

\begin{example}{}{}
	Given $A=-\frac i2$, $B=-\frac i5$ and $C=\frac 1{5}(3-i)$, we find $\textcolor{red}{d(A,B)}$, $\textcolor{blue}{d(A,C)}$ and $\measuredangle BAC$.\smallbreak
	Start by moving $A$ to the origin and consider $f(B)$, $f(C)$:
	\begin{gather*}
		f(z)=\frac{-\frac i2-z}{\frac i2z-1} =\frac{2z+i}{2-iz} \implies 
		f(B)=\frac{-\frac{2i}5+i}{2-\frac 15} =\frac i3\\
		f(C)=\frac{\frac 25(3-i)+i}{2-\frac i5(3-i)} =\frac{2(3-i)+5i}{10-i(3-i)} =\frac{2+i}{3-i}= \frac{(2+i)(3+i)}{10} =\frac{1+i}2
	\end{gather*}
	\begin{minipage}[t]{0.67\linewidth}\vspace{0pt}
		By mapping $A$ to the origin, \textcolor{red}{two} \textcolor{blue}{sides} of the triangle are now \emph{Euclidean straight lines} and the computations are easy:
		\begin{gather*}
	  	\textcolor{red}{d(A,B)} =d\bigl(O,f(B)\bigr) =\ln\frac{1+\frac 13}{1-\frac 13} =\ln 2\\
	  	\textcolor{blue}{d(A,C)} =d\bigl(O,f(C)\bigr) =\ln\frac{1+\frac 1{\sqrt 2}}{1-\frac 1{\sqrt 2}} =2\ln (\sqrt 2+1)\\[-3pt]
	  	\measuredangle BAC =\measuredangle f(B)f(A)f(C) =\arg\frac i3-\arg\frac{1+i}2 =\frac\pi 2-\frac\pi 4 =\frac\pi 4
		\end{gather*}
		To compute the final side and angles, isometries moving $B$ and then $C$ to the origin could be used.
	\end{minipage}
	\hfill
	\begin{minipage}[t]{0.32\linewidth}\vspace{-2pt}
		\flushright\includegraphics[scale=0.95]{calc-triangle}
	\end{minipage}
\end{example}



\boldsubsubsection{Interpretation of Isometries (non-examinable)}\phantomsection\label{pg:hypisomclass}

As in Euclidean geometry, isometries can be interpreted as rotations, reflections and translations. Here is the dictionary in hyperbolic space.\par

\begin{minipage}[t]{0.75\linewidth}\vspace{-3pt}
	\begin{description}
		\item[\normalfont\emph{Translations}] Move $\alpha$ to the origin via $T_{-\alpha}(z)=\frac{\alpha-z}{\cl\alpha z-1}$\par
		The picture shows repeated applications of $T_{-\alpha}$ to seven initial points.\par
	Compose these to translate $\alpha$ to $\beta$:
		\[
			T_{\beta}\circ T_{-\alpha}(z)=\frac{(\cl\alpha\beta-1)z+\alpha-\beta}{(\cl\alpha-\cl\beta)z+\alpha\cl\beta-1}
		\]
	
		\item[\normalfont\emph{Rotations}] $R_\theta(z)=e^{i\theta}z$ rotates counter-clockwise around the origin. To rotate around $\alpha$, one computes the composition
		\[
			T_{\alpha}\circ R_\theta\circ T_{-\alpha}
		\]
		The picture shows repeated rotation by $\ang{30}=\frac\pi 6$ around $\alpha$.
	
		\item[\normalfont\emph{Reflections}] $P_\theta(z)=e^{2i\theta}\cl z$ reflects across the line making angle $\theta$ with the real axis. Composition permits more general reflections, e.g.,
		\[
			T_{\alpha}\circ P_\theta\circ T_{-\alpha}
		\]
	\end{description}
\end{minipage}
\hfill
\begin{minipage}[t]{0.24\linewidth}\vspace{-3pt}
	\flushright\includegraphics[scale=0.95]{isom-trans}\\
	\includegraphics[scale=0.95]{isom-rotate}
\end{minipage}

\goodbreak



\boldsubsubsection{Hyperbolic Trigonometry}

By employing isometries in the abstract, we can develop formulas\footnote{Treat the formulas of hyperbolic trigonometry as open-book---they are not worth memorizing!} allowing us to solve triangles without the explicit requirement to compute with isometries at all!


\smallbreak

Given a right-triangle, we may suppose an isometry has already moved the right-angle to the origin and the other sides to the positive axes as in the picture. The non-hypotenuse side-lengths are\par
\begin{minipage}[t]{0.675\linewidth}\vspace{-8pt}
	\[
		a=\ln\frac{1+p}{1-p}=\cosh^{-1}\frac{1+p^2}{1-p^2},\qquad b=\cosh^{-1}\frac{1+q^2}{1-q^2}
	\]
	To measure the hypotenuse, translate $p$ to the origin via an isometry
	\[
		f(z)=\frac{p-z}{pz-1} \implies f(iq)=\frac{p-iq}{ipq-1} \implies \nm{f(iq)}^2=\frac{p^2+q^2}{p^2q^2+1}
	\]
\end{minipage}
\hfill
\begin{minipage}[t]{0.3\linewidth}\vspace{0pt}
	\flushright\includegraphics[scale=0.9]{isom-right}
\end{minipage}\medbreak
We therefore see that
\[
	\cosh c=\frac{1+\nm{f(iq)}^2}{1-\nm{f(iq)}^2}  =\frac{1+p^2q^2+p^2+q^2}{1+p^2q^2-p^2-q^2} =\frac{1+p^2}{1-p^2}\cdot\frac{1+q^2}{1-q^2} =\cosh a\cosh b
\]
Moreover, applying the hyperbolic identity $\sinh^2b=\cosh^2b-1$, we obtain
\[
	\sinh b=\frac{2q}{1-q^2}\implies \tanh b=\frac{\sinh b}{\cosh b} =\frac{2q}{1+q^2}
\]
Writing $f(iq)$ in real and imaginary parts allows us to find the \textcolor{red}{slope}
\[
	f(iq)=\frac{p-iq}{ipq-1} =\frac{-p(1+q^2)+iq(1-p^2)}{p^2q^2+1}\implies \textcolor{Green}{\tan B}=\frac{q(1-p^2)}{p(1+q^2)} =\frac{\textcolor{Green}{\tanh b}}{\textcolor{blue}{\sinh a}}
\]
Applying trigonometric identities such as $\csc^2B=1+\cot^2B$, we eventually conclude:

\begin{thm}{}{hyptrig}
	In a hyperbolic right-triangle with adjacent $a$, opposite $b$, and hypotenuse $c$,
	\[
		\sin B=\frac{\sinh b}{\sinh c}\qquad \cos B=\frac{\tanh a}{\tanh c}\qquad  \tan B=\frac{\tanh b}{\sinh a}\qquad \cosh c=\cosh a\cosh b
	\]
	This last is Pythagoras' Theorem for hyperbolic right-triangles.
\end{thm}


\begin{example}{}{}
	A right-triangle has non-hypotenuse sides $\textcolor{blue}{a=\cosh^{-1}3\approx 1.76}$, \ $\textcolor{Green}{b=\cosh^{-1}5\approx 2.29}$.
	\begin{gather*}
		\cosh c=\cosh a\cosh b=15\implies \textcolor{red}{c=\cosh^{-1}15\approx 3.40}\\
		\sin A=\frac{\sinh a}{\sinh c} =\sqrt{\frac{\cosh^2a-1}{\cosh^2 c-1}} =\sqrt{\frac{3^2-1}{15^2-1}} =\frac 1{2\sqrt 7} \implies \textcolor{blue}{A\approx \ang{10.9}}\\
		\sin B=\frac{\sinh b}{\sinh c} =\sqrt{\frac{\cosh^2b-1}{\cosh^2 c-1}} =\sqrt{\frac{5^2-1}{15^2-1}}=\sqrt{\frac 3{28}} \implies \textcolor{Green}{B\approx \ang{19.1}}
	\end{gather*}
	You could use the other trig expressions to calculate: e.g., $\tan A=\smash{\frac{\tanh a}{\sinh b}=\frac{\sinh a}{\cosh a\sinh b}=\frac{\sqrt 8}{3\sqrt{24}} =\frac 1{3\sqrt 3} \ldots}$
\end{example}

\goodbreak

The goal of trigonometry is to `solve' triangles: given minimal numerical data, to compute the remaining sides and angles. As in Euclidean geometry, you can attack general problems by dropping perpendiculars and using the results of Theorem \ref{thm:hyptrig}, though it is helpful to generalize this by developing the sine and cosine rules.

\begin{cor}{Sine/Cosine rules and the Cosh-distance formula}{hypcossinerule}
	Label a general triangle with angle-measures $A,B,C$ opposite sides with (hyperbolic) lengths $a,b,c$.
	\begin{description}
		\begin{minipage}[t]{0.74\linewidth}\vspace{-8pt}
			\item[Sine Rule] Drop a perpendicular from $C$ and observe that $\sin A=\frac{\sinh h}{\sinh b}$ and $\sin B=\frac{\sinh h}{\sinh a}$. Eliminate $\sinh h$ to obtain the first equality in
			\[
				\frac{\sinh a}{\sin A}=\frac{\sinh b}{\sin B}=\frac{\sinh c}{\sin C}
			\]
			Drop a different altitude for the other equality.
		\end{minipage}
		\hfill
		\begin{minipage}[t]{0.25\linewidth}\vspace{-15pt}
			\flushright\includegraphics[scale=0.9]{isom-sine}
		\end{minipage}\par
			
		\item[Cosine Rule I] Repeat the argument of Theorem \ref{thm:hyptrig} for a triangle with vertices $0,p$ and $qe^{iC}$ to obtain
		\[
			\cosh c=\cosh a\cosh b-\sinh a\sinh b\cos C
		\]
		Expressing the right-hand side in terms of $p,q$ ($\cosh a=\frac{1+p^2}{1-p^2}$, \ etc.) and applying the Euclidean cosine rule ($\cos C=\cdots$) yields the original cosh-formula for distance (page \pageref{lemm:distformula}).
		\item[Cosine Rule II] Hyperbolic geometry admits a second version:
		\[
			\cos C=\sin A\sin B\cosh c-\cos A\cos B
		\]
		A proof is in Exercise \ref{exs:hcosruleII}.
	\end{description}
\end{cor}


In hyperbolic geometry, the triangle congruence theorems (SAS, ASA, SSS, SAA \emph{and} AAA) provide suitable minimal data. The second version of the cosine rule has no analogue in Euclidean geometry---it is particularly helpful for solving triangles given ASA or AAA data.\footnote{Unlike in Euclidean geometry, knowing two angles doesn't automatically give you the third! For SAS and SSS start with the cosine rule. SAA data is best solved by dropping a perpendicular and using Theorem \ref{thm:hyptrig}.}

\begin{examples}{}{hyptrig}
	\exstart (SAS)\quad An isosceles triangle has angle $C=\frac{\pi}3$ and sides $a=b=\cosh^{-1}2\approx 1.32$.
	\begin{enumerate}\setcounter{enumi}{1}
	  \begin{minipage}[t]{0.69\linewidth}\vspace{-10pt}
	  	\item[] We have $\textcolor{blue}{\sinh a}=\textcolor{Green}{\sinh b} = \textcolor{blue}{\sqrt{\cosh^2\!a-1}}=\sqrt 3$. By the cosine rule,
		\[
			\textcolor{red}{\cosh c} = \textcolor{blue}{2} \, \cdot \textcolor{Green}{2} -\textcolor{blue}{\sqrt 3} \, \textcolor{Green}{\sqrt 3}\cdot \textcolor{Green}{\frac 12} =\frac 52\implies \textcolor{red}{c=\cosh^{-1}\frac 52\approx 1.57}
		\]
		Apply the sine rule for the final angle:
		\begin{gather*}
			\textcolor{Green}{\sin B}=\textcolor{blue}{\sin A}=\frac{\textcolor{red}{\sin C} \, \textcolor{blue}{\sinh a}}{\textcolor{red}{\sinh c}} = \textcolor{red}{\frac{\sqrt 3}2}\cdot\frac{\textcolor{blue}{\sqrt 3}}{\textcolor{red}{\sqrt{21/4}}} =\frac 3{\sqrt{21}}=\sqrt{\frac 37}\\
			\implies \textcolor{Green}{A}=\textcolor{blue}{B}\approx \ang{40.9}
		\end{gather*}
		The area of the triangle is therefore $\pi-\frac{\pi}3-2\sin^{-1}\sqrt{\frac 37}\approx 0.67$
	  \end{minipage}
	  \hfill
	  \begin{minipage}[t]{0.3\linewidth}\vspace{0pt}
	  	\flushright\includegraphics{isom-trigsas}
	  \end{minipage}

	 	
	 	\goodbreak
	 	
	 	\item (Equilateral AAA)\lstsp An equilateral triangle has interior angles $\ang{30}$. We compute its side-length using the second version of the cosine rule:\par
	 	\begin{minipage}[t]{0.65\linewidth}\vspace{-8pt}
	 	\begin{gather*}
	 		\cosh c =\frac{\textcolor{blue}{\cos A}\,\textcolor{Green}{\cos B}+\textcolor{red}{\cos C}}{\textcolor{blue}{\sin A}\,\textcolor{Green}{\sin B}} =\frac{\frac{\sqrt 3}2\cdot\frac{\sqrt 3}2+\frac{\sqrt 3}2}{\frac 12\cdot\frac 12} =3\sqrt 3\\
	 		\implies a=b=c=\cosh^{-1}(3\sqrt 3) \approx 2.33
	 	\end{gather*}
	  \end{minipage}
	  \hfill
	  \begin{minipage}[t]{0.34\linewidth}\vspace{-8pt}
	  	\flushright\includegraphics{isom-trigequil}
	  \end{minipage}
	 	
	 	\item\label{ex:rtangleaaa} (Right-angled AAA)\lstsp A triangle has angles $\frac\pi 6,\frac\pi 4$ and $\frac\pi 2$: find its sides.\smallbreak
	  \begin{minipage}[t]{0.71\linewidth}\vspace{-10pt}
	  	Rather than using the second version of the cosine rule, we instead indicate part of its proof by employing the tan-formula twice,
		  \begin{gather*}
		  	\frac 1{\sqrt 3} =\textcolor{blue}{\tan\frac\pi 6} =\frac{\textcolor{blue}{\tanh a}}{\textcolor{Green}{\sinh b}}=\frac{\sinh a}{\cosh a\sinh b}\\
		  	1=\textcolor{Green}{\tan\frac\pi 4}=\frac{\textcolor{Green}{\tanh b}}{\textcolor{blue}{\sinh a}}=\frac{\sinh b}{\sinh a\cosh b}
		  \end{gather*}
		  Multiply together and use hyperbolic Pythagoras,
	  \end{minipage}
	  \hfill
	  \begin{minipage}[t]{0.28\linewidth}\vspace{-20pt}
	  	\flushright\includegraphics{isom-right2}
	  \end{minipage}\par
	  \[
	  	\frac 1{\sqrt 3}=\frac 1{\textcolor{blue}{\cosh a}\,\textcolor{Green}{\cosh b}}=\frac 1{\textcolor{red}{\cosh c}}\implies \textcolor{red}{c=\cosh^{-1}\sqrt 3=\ln(\sqrt 3+\sqrt 2)\approx 1.15}
	  \]
	  Since $\sinh c=\sqrt{\cosh^2c-1}=\sqrt 2$, the sine-rule yields the other sides:
	  \begin{gather*}
		  \textcolor{Green}{\sinh b} =\textcolor{Green}{\sin\frac\pi 4}\cdot\frac{\textcolor{red}{\sinh c}}{\textcolor{red}{\sin\pi}} =1 \implies \textcolor{Green}{b=\sinh^{-1} 1 =\cosh^{-1}\sqrt 2\approx 0.88}\\
		  \implies \textcolor{blue}{\cosh a} =\frac{\textcolor{red}{\cosh c}}{\textcolor{Green}{\cosh b}}=\sqrt{\frac 32} \implies \textcolor{blue}{a=\cosh^{-1}\sqrt{\frac 32}\approx 0.66}
	  \end{gather*}
	  
	  \item (ASA)\lstsp Solve a triangle with angles $\frac\pi 6$, $\frac\pi 3$ and a distance $\cosh^{-1}3$ between them.\par
	  \begin{minipage}[t]{0.65\linewidth}\vspace{-5pt}
	  	Apply the second version of the cosine rule:
	  	\begin{align*}
	  		\textcolor{red}{\cos C}& =\textcolor{blue}{\sin A} \, \textcolor{Green}{\sin B} \, \textcolor{red}{\cosh c}-\textcolor{blue}{\cos A} \, \textcolor{Green}{\cos B}\\
	  		&=\textcolor{blue}{\frac 12} \cdot \textcolor{Green}{\frac{\sqrt 3}2} \cdot \textcolor{red}{3} - \textcolor{blue}{\frac{\sqrt 3}2} \cdot \textcolor{Green}{\frac 12} =\frac{\sqrt 3}2 \implies\textcolor{red}{C=\frac\pi 6}
	  	\end{align*}
	  	The triangle is isosceles, whence $\textcolor{blue}{a=\cosh^{-1}3}$ also.
	  \end{minipage}
	  \hfill
	  \begin{minipage}[t]{0.34\linewidth}\vspace{-8pt}
	  	\flushright\includegraphics{isom-trigasa}
	  \end{minipage}\par
	  The remaining side can be found using multiple methods: here is the cosine rule
	  \begin{gather*}
	  	\textcolor{Green}{\cosh b}=\textcolor{blue}{\cosh a} \, \textcolor{red}{\cosh c} - \textcolor{blue}{\sinh a} \, \textcolor{red}{\sinh c} \, \textcolor{Green}{\cos B} =9-\bigl(\sqrt{3^2-1}\bigr)^2\frac 12 =5\\
	  	\implies \textcolor{Green}{b=\cosh^{-1}5=\ln(5+\sqrt{24})\approx 2.29}
	  \end{gather*}
	  
	\end{enumerate}
\end{examples}





\boldsubsubsection{Hyperbolic Tilings (just for fun!)}\phantomsection\label{pg:hyptiling}

The first example above can be used to make a regular tiling of hyperbolic space.\par

\begin{minipage}[t]{0.55\linewidth}\vspace{0pt}
	Take eight congruent copies of the triangle and arrange them around the origin as in the picture. Now reflect the quadrilateral over each of its edges and repeat the process in all directions. We obtain a regular tiling of hyperbolic space comprising \emph{four-sided} figures with \emph{six} meeting at every vertex!\medbreak
	
	In hyperbolic space, many different regular tilings are possible. Suppose such is to be made using regular $m$-sided polygons, $n$ of which are to meet at each vertex: each polygon comprises $2m$ copies of the fundamental right-triangle, whose angles are therefore $\frac\pi 2, \frac\pi m$ and $\frac\pi n$.
	Since the angles sum to less than $\pi$ radians, we see that there exists a regular tiling of hyperbolic space whenever $m,n$ satisfy
	\[
		\frac\pi 2+\frac\pi m+\frac\pi n<\pi\iff (m-2)(n-2)>4
	\]
	The first example is $m=4$ and $n=6$, where the fundamental triangle is clear. In the second example four pentagons meet at each vertex and the interiors of the polygons have been colored. This was produced using the tools found
	\href{http://www.malinc.se/noneuclidean/en/poincaretiling.php}{here} and \href{http://www.malinc.se/m/ImageTiling.php}{here}: have a play!\medbreak
	
	The multitude of possible tilings in hyperbolic geometry is in contrast to Euclidean geometry, where a regular tiling requires \emph{equality}
	\[
		(m-2)(n-2)=4
	\]
	The three solutions $(m,n)=(3,6)$, $(4,4)$, $(6,3)$ correspond to the only tilings of Euclidean geometry by regular polygons (equilateral triangles, squares and hexagons). However, all can be scaled to arbitrary side-lengths. In hyperbolic geometry, there are infinitely many distinct tilings, but each has a unique side-length.\bigbreak
	
	For related fun, look up M.C.\,Escher's \emph{Circle Limit} artworks, some of which are based on hyperbolic tilings.
	If you want an excuse to play video games while pretending to study geometry, have a look at \href{http://www.roguetemple.com/z/hyper/}{Hyper Rogue}, which relies on (sometimes irregular) tilings.
\end{minipage}
\hfill
\begin{minipage}[t]{0.44\linewidth}\vspace{-20pt}
	\centering
	\includegraphics{isom-right3}\\
	The fundamental triangle\bigbreak
	\includegraphics{isom-tiling}\\
	$(m,n)=(4,6)$\bigbreak
	\includegraphics[scale=0.112]{tiling}\\
	$(m,n)=(5,4)$
\end{minipage}
\goodbreak



\begin{exercises}
	\hangindent\leftmargini
	1. \ Use Definition \ref{defn:hypdist2} to prove that $d(z,0)=\ln\frac{1+\nm z}{1-\nm z}$.\vspace{-5pt}
	\begin{enumerate}\setcounter{enumi}{1}
	  %\item[](\emph{Hint: what are the omega-points for the line through $0$ and $z$?})
	  %
	  \item\begin{enumerate}
	    \item Use an isometry to find angle $\measuredangle ABC$ when $A=0$, $B=\frac i2$, and $C=\frac{1+i}2$.
	    \item Now compute $\measuredangle ACB$, and thus find the angle sum and area of the triangle.
	  \end{enumerate} 
	
	  \item Associate a Möbius transformation $f(z)=\frac{az+b}{cz+d}$ with the matrix
	  $\begin{smatrix}
	  	a&b\\
	  	c&d
	  \end{smatrix}$
	  in the obvious way. If $g$ is another Möbius transformation, prove that the composition $f\circ g$ is associated to the product of the matrices associated to $f,g$. Verify\footnotemark{} that $f^{-1}(z)=\frac{dz-b}{a-cz}$.
	  
	  \item\begin{enumerate}
	    \item A triangle has vertices $A=\frac 13$, $B=\frac 12$ and $C$, where $C$ lies in the upper half-plane (positive imaginary part) such that $\measuredangle{BAC}=\ang{45}$ and $b=d(A,C)=\cosh^{-1}3$\par
	    Compute $a=d(B,C)$ using the hyperbolic cosine rule.
	    
	    \item The isometry $f(z)=\frac{\frac 13-z}{\frac 13z-1}=\frac{1-3z}{z-3}$ moves $A$ to the origin. What is $f(B)$ and therefore $f(C)$?\par
	   	(\emph{Hint: remember that $f$ is orientation preserving})
	    
	    \item Use the \emph{inverse} of the isometry $f$ to compute the co-ordinates of $C$. As a sanity-check, use the cosh distance formula to recover your answer to part (a).    
	  \end{enumerate}
	  
	  
	  \item Suppose $f(z)=\frac{\alpha-z}{\cl\alpha z-1}$ for some constant $\alpha\in\C$ with $\nm{\alpha}\neq 1$. If $\nm z=1$, prove that $\nm{f(z)}=1$.\par
	  Argue that the functions $f$ in Theorem \ref{thm:hypisomclass} really do map the interior of the unit disk to itself.
	  
	  
 		\item Provided $\alpha\neq\beta$, show that the isometry $T_\beta\circ T_{-\alpha}$ which translates $\alpha$ to $\beta$ (page \pageref{pg:hypisomclass}) is the translation $T_{-\gamma}$ where $\gamma=\frac{\beta-\alpha}{\cl\alpha\beta-1}$ followed by a rotation around the origin.
	
	  
		\item Use the power series $\cosh x=1+\frac 12x^2+\frac 1{4!}x^4+\cdots$ to expand the hyperbolic Pythagorean theorem $\cosh c=\cosh a\cosh b$ to order 4 ($a^4$, $a^2b^2$, etc.). What do you observe?
	
	  
	  \item A hyperbolic right-triangle has non-hypotenuse sides $a=\cosh^{-1}2$ and $b=\cosh^{-1}3$. Find the hypotenuse, the angles and the area of the triangle.
	  
	  
		\item Given ASA data $c=\cosh^{-1}(\sqrt 2+\sqrt 3)$, $A=\frac\pi 4$, $B=\frac\pi 6$, find the remaining data for the triangle.
	  
	  
		\item An equilateral hyperbolic triangle has side-length $a$ and angle $A$. Prove that $\cosh a =\frac{\cos A}{1-\cos A}$. If $A=\ang{45}$, what is the side-length?
		
		
		\item Find the interior angles and side-lengths for the quadrilateral and pentagonal tiles on page \pageref{pg:hyptiling}.
		
		 
		\item Use the hyperbolic cosine rule to prove that the cosh distance formula is valid.
	
		
		\item Suppose you are given isosceles ASA data: angles $A=B$ and side $c$ between them. Prove that $c\le\cosh^{-1}(2\csc^2A-1)$. What happens when this is equality?
		
				
 		\item\label{exs:hcosruleII}
 		\begin{enumerate}
		  \item Prove the second cosine rule when $C=\frac\pi 2$ (see the trick in Example \ref*{ex:hyptrig}.\ref{ex:rtangleaaa}).
		  \item (Hard!)\lstsp Prove the full version by dropping a perpendicular from $B=B_1+B_2$ and observing that $\frac{\cos A}{\sin B_1}=\frac{\cos C}{\sin B_2}=\frac{\cos C}{\sin(B-B_1)}$\ldots
		\end{enumerate}
	\end{enumerate}
\end{exercises}

\footnotetext{Since multiplying $a,b,c,d$ by a non-zero scalar doesn't change $f$, we see that the group of Möbius transformations is isomorphic to the \emph{projective special linear group} $\mathrm{PSL}_2(\R)$. The isometries of hyperbolic space form a proper subgroup.}


\vfil\goodbreak





\boldsubsubsection{The Poincaré Disk for Differential Geometers (non-examinable)}

This last optional section should be accessible to anyone who's taken a vector-calculus course covering line-integrals and surface area. All we really need is the Poincaré disk model with its distance function $d(z,w)$ and description of the isometries (Theorems \ref{thm:mobius}, \ref{thm:hypisomclass}).\smallbreak

\begin{minipage}[t]{0.69\linewidth}\vspace{0pt}
	We first need a way to measure infinitesimal change. Consider the infinitesimally separated points $z$ and $z+\dz$. Use an isometry
	\[
		f:\xi\mapsto \frac{z-\xi}{\cl z\xi-1}
	\]
	to map $z$ to the origin. Then $z+\dz$ is mapped to
	\[
		P:=f(z+\dz)=\frac{-\dz}{\cl z(z+\dz)-1} =\frac{\dz}{1-\nm z^2}
	\]
\end{minipage}
\hfill
\begin{minipage}[t]{0.3\linewidth}\vspace{-15pt}
	\flushright\includegraphics{isom-arclength}
\end{minipage}\par
where we deleted the $\cl z\,\dz$ term since it is infinitesimally small compared to $1-\nm z^2$.\smallbreak
Since isometries must preserve length and angle, this construction has several consequences:
\begin{description}
	\item[Angle measure]\phantomsection\label{pg:hypareaext} If we repeat the exercise for a second infinitesimal \textcolor{Green}{segment} $z\to z+\dw$, we see that the \textcolor{orange}{angle} between the original segments is precisely that between the infinitesimal vectors $\dz$ and $\dw$. This is precisely the conformality observation in Theorem \ref{thm:mobius}, and moreover shows how the distance function determines the angle measure.
	\item[Infinitesimal distance and arc-length] The hyperbolic distance from $z$ to $z+\dz$ is
	\[
		d(z,z+\dz)=d(O,P)=\ln\frac{1+\nm P}{1-\nm P} =\ln(1+\nm{P})-\ln(1-\nm{P})=2\nm{P}=\frac{2\nm{\dz}}{1-\nm{z(t)}^2}
	\]
	where the approximation $\ln(1\pm\nm P)=\pm\nm P$ is used since $\nm P$ is infinitesimal.\smallbreak
	If $z(t)$ parametrizes a curve in the disk, then the infinitesimal distance formula allows us to compute the arc-length
	\[
		\int_{t_0}^{t_1}\frac{2\nm{z'(t)}}{1-\nm{z(t)}^2}\,\dt
	\]
	\item[Area] If $\dx$ and $i\dy$ are infinitesimal horizontal and vertical changes in $z=x+iy$, then the area of the infinitesimal rectangle spanned by $z\to z+\dx$ and $z\to z+i\dy$ is the area element
	\[
		\dA=\frac{2\,\dx}{1-\nm z^2}\frac{2\,\dy}{1-\nm z^2} =\frac{4\,\dx\dy}{(1-x^2-y^2)^2}
	\]
	The area of a region $R$ in the Poincaré disk is therefore given by the double integrals
	\[
		\iint_R\frac{4\,\dx\dy}{(1-x^2-y^2)^2}=\iint_R\frac{4r\,\dr\,\dth}{(1-r^2)^2} =\iint_R\sinh\delta\,\D\delta\,\dth
	\]
	where the last expression is written in polar co-ordinates using the hyperbolic distance $\delta$. In this way the measure of area also depends on the distance function.
\end{description}

\begin{example}{Circles and `hyperbolic $\pi$'}{}
	Suppose that a circle has hyperbolic radius $\delta$. By moving its center to the origin via an isometry, we can parametrize it in the usual manner:
	\[
		z(t)=r\twovec{\cos\theta}{\sin\theta},\quad \theta\in[0,2\pi)
		\quad\text{where}\quad 
		\delta=\ln\frac{1+r}{1-r}\rightsquigarrow r=\frac{e^\delta-1}{e^\delta+1}
	\]
	Its circumference (hyperbolic arc-length) is then
	\[
		\int_0^{2\pi}\frac{2 r}{1-r^2}\,\dth =\frac{4\pi r}{1-r^2} =2\pi\sinh\delta =2\pi\left(\delta+\frac{1}{3!}\delta^3+\frac{1}{4!}\delta^5+\cdots\right)>2\pi\delta
	\]
	where we used the Maclaurin series to compare. Its area is
	\[
		\int_0^{2\pi}\int_0^\delta\sinh\delta\,\D\delta\,\dth =2\pi(\cosh\delta-1) =\pi\left(\delta^2+\frac{2}{4!}\delta^4+\frac{2}{6!}\delta^6+\cdots\right)>\pi\delta^2
		\]
	A hyperbolic circle therefore has larger ratios of circumference\,:\,radius and area\,:\,radius${}^2$ than for a Euclidean circle. Moreover, these ratios are \emph{not constant}: one might say that the hyperbolic version of $\pi$ is a function!
\end{example}


\boldinline{Hyperbolic Lines as Geodesics}

Finally, we perform a calculus of variations argument to see that the distance function in fact \emph{defines} our notion of a hyperbolic line.

% \begin{defn*}{}{}
% 	A \emph{geodesic} is a path of shortest length between two points.
% \end{defn*}

\begin{thm}{}{}
	The geodesics---path of shortest length between two points---in the Poincaré disk are precisely the hyperbolic lines.
\end{thm}

\begin{proof}
	First suppose that $b$ lies on the positive $x$-axis. Parametrize a curve from $0$ to $b$ via
	\[
		z(t)=x(t)+iy(t)\quad\text{where}\quad 0\le t\le 1,\quad z(0)=0,\ z(1)=b
	\]
	Now compute its arc-length:
	\begin{align*}
		\int_{0}^{1}\frac{2\nm{z'(t)}}{1-\nm{z(t)}^2}\,\dt
		&=\int_{0}^{1}\frac{2\sqrt{x'^2+y'^2}}{1-x^2-y^2}\,\dt\ge \int_{0}^{1}\frac{2\nm{x'}}{1-x^2}\,\dt\ge \int_{0}^{1}\frac{2x'(t)}{1-x(t)^2}\,\dt =\int_0^b\frac{2\,\dx}{1-x^2}\\
		&=\ln\frac{1+b}{1-b}=d(0,b)
	\end{align*}
	where we have equality if and only if $y(t)\equiv 0$ and $x(t)$ is increasing. The length-minimizing path is therefore along the $x$-axis.\smallbreak
	More generally, given points $A,B$, apply an isometry $f$ such that $f(A)=0$ and $f(B)=b$ lies on the positive $x$-axis. The geodesic from $A$ to $B$ is therefore the image of the segment $\cl{0b}$ under the inverse isometry $f^{-1}$. By the properties of Möbius transforms, this is an arc of a Euclidean circle through $A,B$ intersecting the unit circle at right-angles, our original definition of a hyperbolic line.
\end{proof}
